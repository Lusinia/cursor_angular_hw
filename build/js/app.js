"use strict";var shopApp=angular.module("shopApp",["ngRoute","ngAnimate"]);shopApp.config(["$routeProvider","$locationProvider",function(t,r){t.when("/",{templateUrl:"../partials/home.html",controller:"mainController"}).when("/add",{templateUrl:"../partials/add.html",controller:"addProduct"}).when("/orders",{templateUrl:"../partials/orders.html",controller:"ShowOrders"}).when("/product/:id",{templateUrl:"../partials/product.html",controller:"ShowProduct"}).otherwise({redirectTo:"/orders"})}]),shopApp.factory("productsFactory",["$http",function(t){var r=function(){return t.get("http://localhost:8080/")},o=[],e={};return e.getJSON=function(){return r()},e.getProducts=function(){return o},e.setProducts=function(t){o=t},e.addProduct=function(r){t({method:"post",url:"http://localhost:8080/",data:JSON.stringify(r),config:"Content-Type: application/json;"}).then(function(t){console.log(t)},function(t){console.log(t)})},e.deleteProduct=function(r){var o={index:r.index,productId:r.product.id};t.delete("http://localhost:8080/product/"+o.productId,{params:o}).then(function(t){console.log(t)})},e.findProductById=function(t){var r=void 0;return o.forEach(function(o){o.id==t&&(r=o)}),r},e}]),shopApp.factory("ordersFactory",function(){var t=[{id:1,title:"Cat in the dark",img:"./img/cat2.jpg",desc:"Its just me",cost:"50",quantity:1}],r={};return r.getOrders=function(){return t},r.addOrder=function(r){if(t.length>0){var o=!1;t.forEach(function(t){r.title===t.title&&(o=!0,t.quantity++)}),o||t.push(r)}},r.defineCostForItems=function(t){var r=0;return t.forEach(function(t){r+=+t.cost}),r},r}),shopApp.controller("mainController",["$scope","$location","$routeParams","productsFactory","ordersFactory",function(t,r,o,e,n){t.pageStyle="mainPageStyle",t.pageClass="page-style",t.products=[],t.orders=[],t.item={};var d=function(){e.getJSON().then(function(r){var o=[];r.data.forEach(function(t){var r={};r.description=t.description,r.title=t.title,r.img=t.img,r.genre=t.genre,r.cost=t.cost,r.id=t.id,o.push(r)}),e.setProducts(o),t.products=o})};t.products=d(),t.orders=n.getOrders()}]),shopApp.controller("ShowProduct",["$scope","$routeParams","productsFactory","ordersFactory",function(t,r,o,e){t.pageStyle="showProductStyle",t.ProductId=r.id;var n=o.findProductById(t.ProductId);t.img=n.img,t.title=n.title,t.genre=n.genre,t.description=n.description,t.cost=n.cost,t.products=o.getProducts(),t.addOrder=function(t){e.addOrder({title:n.title,id:e.getOrders().length+1,cost:n.cost,quantity:1})},t.deleteProduct=function(){var r=t.products.indexOf(n);o.deleteProduct({index:r,product:n})}}]),shopApp.controller("ShowOrders",["$scope","$routeParams","productsFactory","ordersFactory",function(t,r,o,e){t.pageStyle="showOrdersStyle",t.orders=[],t.sum=e.defineCostForItems(e.getOrders()),t.item={},t.selected={value:0};t.orders=e.getOrders(),t.removeOrder=function(r){t.orders[r].quantity>1?t.orders[r].quantity-=1:1===t.orders[r].quantity&&t.orders.splice(r,1)}}]),shopApp.controller("addProduct",["$scope","productsFactory",function(t,r){t.pageStyle="addStyle",t.addProduct=function(){r.addProduct({title:t.newProduct.title,img:t.newProduct.img,description:t.newProduct.desc,genre:t.newProduct.genre,cost:t.newProduct.cost,id:Math.random()})}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJzaG9wQXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsImZhY3RvcnkiLCIkaHR0cCIsInJlY2lldmVEYXRhIiwiZ2V0IiwicHJvZHVjdHMiLCJnZXRKU09OIiwiZ2V0UHJvZHVjdHMiLCJzZXRQcm9kdWN0cyIsImRhdGEiLCJhZGRQcm9kdWN0IiwiaXRlbSIsIm1ldGhvZCIsInVybCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGVuIiwicmVzcG9uc2UiLCJjb25zb2xlIiwibG9nIiwiZGVsZXRlUHJvZHVjdCIsInByb2R1Y3RJbmZvIiwiaW5kZXgiLCJwcm9kdWN0SWQiLCJwcm9kdWN0IiwiaWQiLCJkZWxldGUiLCJwYXJhbXMiLCJmaW5kUHJvZHVjdEJ5SWQiLCJmb3VuZCIsImZvckVhY2giLCJvcmRlcnMiLCJ0aXRsZSIsImltZyIsImRlc2MiLCJjb3N0IiwicXVhbnRpdHkiLCJnZXRPcmRlcnMiLCJhZGRPcmRlciIsImxlbmd0aCIsImlzQ29pbmNpZGVuY2UiLCJvcmRlciIsInB1c2giLCJkZWZpbmVDb3N0Rm9ySXRlbXMiLCJzdW0iLCIkc2NvcGUiLCIkbG9jYXRpb24iLCIkcm91dGVQYXJhbXMiLCJwcm9kdWN0c0ZhY3RvcnkiLCJvcmRlcnNGYWN0b3J5IiwicGFnZVN0eWxlIiwicGFnZUNsYXNzIiwiY3JlYXRlTGlzdCIsIml0ZW1zIiwibGlzdCIsImtleSIsImxpc3RJdGVtIiwiZGVzY3JpcHRpb24iLCJnZW5yZSIsIlByb2R1Y3RJZCIsImN1cnJlbnRQcm9kdWN0IiwiaW5kZXhPZiIsInNlbGVjdGVkIiwidmFsdWUiLCJyZW1vdmVPcmRlciIsInNwbGljZSIsIm5ld1Byb2R1Y3QiLCJNYXRoIiwicmFuZG9tIl0sIm1hcHBpbmdzIjoi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QUcsR0FDQUgsRUFBQUssVUFBQSxXQUVBTCxFQUFBbkMsV0FBQSxXQUNBc0MsRUFBQXRDLFlBQ0FzQixNQUFBYSxFQUFBcUIsV0FBQWxDLE1BQ0FDLElBQUFZLEVBQUFxQixXQUFBakMsSUFDQXdCLFlBQUFaLEVBQUFxQixXQUFBaEMsS0FDQXdCLE1BQUFiLEVBQUFxQixXQUFBUixNQUNBdkIsS0FBQVUsRUFBQXFCLFdBQUEvQixLQUNBVixHQUFBMEMsS0FBQUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vIGRlZmluZSBvdXIgYXBwbGljYXRpb24gYW5kIHB1bGwgaW4gbmdSb3V0ZSBhbmQgbmdBbmltYXRlXG52YXIgc2hvcEFwcCA9IGFuZ3VsYXIubW9kdWxlKFwic2hvcEFwcFwiLCBbXCJuZ1JvdXRlXCIsIFwibmdBbmltYXRlXCJdKTtcbi8vXG4vLyBST1VUSU5HID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBzZXQgb3VyIHJvdXRpbmcgZm9yIHRoaXMgYXBwbGljYXRpb25cbi8vIGVhY2ggcm91dGUgd2lsbCBwdWxsIGluIGEgZGlmZmVyZW50IGNvbnRyb2xsZXJcbnNob3BBcHAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCBmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG5cbiAgICAkcm91dGVQcm92aWRlclxuXG4gICAgLy8gaG9tZSBwYWdlXG4gICAgLndoZW4oXCIvXCIsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiLi4vcGFydGlhbHMvaG9tZS5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwibWFpbkNvbnRyb2xsZXJcIlxuICAgIH0pXG5cbiAgICAvLyBhZGQgcGFnZVxuICAgIC53aGVuKFwiL2FkZFwiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcIi4uL3BhcnRpYWxzL2FkZC5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwiYWRkUHJvZHVjdFwiXG4gICAgfSlcblxuICAgIC8vIG9yZGVycyBwYWdlXG4gICAgLndoZW4oXCIvb3JkZXJzXCIsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiLi4vcGFydGlhbHMvb3JkZXJzLmh0bWxcIixcbiAgICAgICAgY29udHJvbGxlcjogXCJTaG93T3JkZXJzXCJcbiAgICB9KVxuXG4gICAgLy8gcHJvZHVjdCBwYWdlXG4gICAgLndoZW4oXCIvcHJvZHVjdC86aWRcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCIuLi9wYXJ0aWFscy9wcm9kdWN0Lmh0bWxcIixcbiAgICAgICAgY29udHJvbGxlcjogXCJTaG93UHJvZHVjdFwiXG4gICAgfSkub3RoZXJ3aXNlKHsgcmVkaXJlY3RUbzogXCIvb3JkZXJzXCIgfSk7XG4gICAgLy8gJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xufV0pO1xuXG4vLyBGQUNUT1JZXG5zaG9wQXBwLmZhY3RvcnkoXCJwcm9kdWN0c0ZhY3RvcnlcIiwgW1wiJGh0dHBcIiwgZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgICB2YXIgcmVjaWV2ZURhdGEgPSBmdW5jdGlvbiByZWNpZXZlRGF0YSgpIHtcbiAgICAgICAgcmV0dXJuICRodHRwLmdldCgnaHR0cDovL2xvY2FsaG9zdDo4MDgwLycpO1xuICAgIH07XG4gICAgdmFyIHByb2R1Y3RzID0gW107XG5cbiAgICB2YXIgZmFjdG9yeSA9IHt9O1xuICAgIGZhY3RvcnkuZ2V0SlNPTiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHJlY2lldmVEYXRhKCk7XG4gICAgfTtcbiAgICBmYWN0b3J5LmdldFByb2R1Y3RzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gcHJvZHVjdHM7XG4gICAgfTtcbiAgICBmYWN0b3J5LnNldFByb2R1Y3RzID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgcHJvZHVjdHMgPSBkYXRhO1xuICAgIH07XG4gICAgZmFjdG9yeS5hZGRQcm9kdWN0ID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgwODAvJyxcbiAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGl0ZW0pLFxuICAgICAgICAgICAgY29uZmlnOiAnQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uOydcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgZmFjdG9yeS5kZWxldGVQcm9kdWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB2YXIgcHJvZHVjdEluZm8gPSB7XG4gICAgICAgICAgICBpbmRleDogZGF0YS5pbmRleCxcbiAgICAgICAgICAgIHByb2R1Y3RJZDogZGF0YS5wcm9kdWN0LmlkXG4gICAgICAgIH07XG4gICAgICAgICRodHRwLmRlbGV0ZSgnaHR0cDovL2xvY2FsaG9zdDo4MDgwL3Byb2R1Y3QvJyArIHByb2R1Y3RJbmZvLnByb2R1Y3RJZCwgeyBwYXJhbXM6IHByb2R1Y3RJbmZvIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgZmFjdG9yeS5maW5kUHJvZHVjdEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgdmFyIGZvdW5kID0gdm9pZCAwO1xuICAgICAgICBwcm9kdWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9kdWN0KSB7XG4gICAgICAgICAgICBpZiAocHJvZHVjdC5pZCA9PSBpZCkge1xuICAgICAgICAgICAgICAgIGZvdW5kID0gcHJvZHVjdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9O1xuICAgIHJldHVybiBmYWN0b3J5O1xufV0pO1xuXG5zaG9wQXBwLmZhY3RvcnkoXCJvcmRlcnNGYWN0b3J5XCIsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3JkZXJzID0gW3tcbiAgICAgICAgaWQ6IDEsXG4gICAgICAgIHRpdGxlOiBcIkNhdCBpbiB0aGUgZGFya1wiLFxuICAgICAgICBpbWc6ICcuL2ltZy9jYXQyLmpwZycsXG4gICAgICAgIGRlc2M6IFwiSXRzIGp1c3QgbWVcIixcbiAgICAgICAgY29zdDogJzUwJyxcbiAgICAgICAgcXVhbnRpdHk6IDFcbiAgICB9XTtcbiAgICB2YXIgZmFjdG9yeSA9IHt9O1xuICAgIGZhY3RvcnkuZ2V0T3JkZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gb3JkZXJzO1xuICAgIH07XG5cbiAgICBmYWN0b3J5LmFkZE9yZGVyID0gZnVuY3Rpb24gKGl0ZW0pIHtcblxuICAgICAgICBpZiAob3JkZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBpc0NvaW5jaWRlbmNlID0gZmFsc2U7XG4gICAgICAgICAgICBvcmRlcnMuZm9yRWFjaChmdW5jdGlvbiAob3JkZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS50aXRsZSA9PT0gb3JkZXIudGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNDb2luY2lkZW5jZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyLnF1YW50aXR5Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIWlzQ29pbmNpZGVuY2UpIHtcbiAgICAgICAgICAgICAgICBvcmRlcnMucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgZmFjdG9yeS5kZWZpbmVDb3N0Rm9ySXRlbXMgPSBmdW5jdGlvbiAob3JkZXJzKSB7XG4gICAgICAgIHZhciBzdW0gPSAwO1xuICAgICAgICBvcmRlcnMuZm9yRWFjaChmdW5jdGlvbiAob3JkZXIpIHtcbiAgICAgICAgICAgIHN1bSArPSArb3JkZXIuY29zdDtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdW07XG4gICAgfTtcbiAgICByZXR1cm4gZmFjdG9yeTtcbn0pO1xuXG4vLyBDT05UUk9MTEVSUyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gaG9tZSBwYWdlIGNvbnRyb2xsZXJcbnNob3BBcHAuY29udHJvbGxlcihcIm1haW5Db250cm9sbGVyXCIsIFtcIiRzY29wZVwiLCBcIiRsb2NhdGlvblwiLCBcIiRyb3V0ZVBhcmFtc1wiLCBcInByb2R1Y3RzRmFjdG9yeVwiLCBcIm9yZGVyc0ZhY3RvcnlcIiwgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkcm91dGVQYXJhbXMsIHByb2R1Y3RzRmFjdG9yeSwgb3JkZXJzRmFjdG9yeSkge1xuICAgICRzY29wZS5wYWdlU3R5bGUgPSAnbWFpblBhZ2VTdHlsZSc7XG4gICAgJHNjb3BlLnBhZ2VDbGFzcyA9IFwicGFnZS1zdHlsZVwiO1xuICAgICRzY29wZS5wcm9kdWN0cyA9IFtdO1xuICAgICRzY29wZS5vcmRlcnMgPSBbXTtcbiAgICAkc2NvcGUuaXRlbSA9IHt9O1xuXG4gICAgdmFyIGNyZWF0ZUxpc3QgPSBmdW5jdGlvbiBjcmVhdGVMaXN0KCkge1xuICAgICAgICBwcm9kdWN0c0ZhY3RvcnkuZ2V0SlNPTigpLnRoZW4oZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgICAgICAgaXRlbXMuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGlzdEl0ZW0gPSB7fTtcbiAgICAgICAgICAgICAgICBsaXN0SXRlbS5kZXNjcmlwdGlvbiA9IGtleS5kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICBsaXN0SXRlbS50aXRsZSA9IGtleS50aXRsZTtcbiAgICAgICAgICAgICAgICBsaXN0SXRlbS5pbWcgPSBrZXkuaW1nO1xuICAgICAgICAgICAgICAgIGxpc3RJdGVtLmdlbnJlID0ga2V5LmdlbnJlO1xuICAgICAgICAgICAgICAgIGxpc3RJdGVtLmNvc3QgPSBrZXkuY29zdDtcbiAgICAgICAgICAgICAgICBsaXN0SXRlbS5pZCA9IGtleS5pZDtcbiAgICAgICAgICAgICAgICBsaXN0LnB1c2gobGlzdEl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwcm9kdWN0c0ZhY3Rvcnkuc2V0UHJvZHVjdHMobGlzdCk7XG4gICAgICAgICAgICAkc2NvcGUucHJvZHVjdHMgPSBsaXN0O1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmFyIGluaXQgPSBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAkc2NvcGUucHJvZHVjdHMgPSBjcmVhdGVMaXN0KCk7XG4gICAgICAgICRzY29wZS5vcmRlcnMgPSBvcmRlcnNGYWN0b3J5LmdldE9yZGVycygpO1xuICAgIH07XG5cbiAgICBpbml0KCk7XG59XSk7XG5zaG9wQXBwLmNvbnRyb2xsZXIoXCJTaG93UHJvZHVjdFwiLCBbXCIkc2NvcGVcIiwgXCIkcm91dGVQYXJhbXNcIiwgXCJwcm9kdWN0c0ZhY3RvcnlcIiwgXCJvcmRlcnNGYWN0b3J5XCIsIGZ1bmN0aW9uICgkc2NvcGUsICRyb3V0ZVBhcmFtcywgcHJvZHVjdHNGYWN0b3J5LCBvcmRlcnNGYWN0b3J5KSB7XG4gICAgJHNjb3BlLnBhZ2VTdHlsZSA9ICdzaG93UHJvZHVjdFN0eWxlJztcbiAgICAkc2NvcGUuUHJvZHVjdElkID0gJHJvdXRlUGFyYW1zLmlkO1xuICAgIHZhciBjdXJyZW50UHJvZHVjdCA9IHByb2R1Y3RzRmFjdG9yeS5maW5kUHJvZHVjdEJ5SWQoJHNjb3BlLlByb2R1Y3RJZCk7XG4gICAgJHNjb3BlLmltZyA9IGN1cnJlbnRQcm9kdWN0LmltZztcbiAgICAkc2NvcGUudGl0bGUgPSBjdXJyZW50UHJvZHVjdC50aXRsZTtcbiAgICAkc2NvcGUuZ2VucmUgPSBjdXJyZW50UHJvZHVjdC5nZW5yZTtcbiAgICAkc2NvcGUuZGVzY3JpcHRpb24gPSBjdXJyZW50UHJvZHVjdC5kZXNjcmlwdGlvbjtcbiAgICAkc2NvcGUuY29zdCA9IGN1cnJlbnRQcm9kdWN0LmNvc3Q7XG4gICAgJHNjb3BlLnByb2R1Y3RzID0gcHJvZHVjdHNGYWN0b3J5LmdldFByb2R1Y3RzKCk7XG5cbiAgICAkc2NvcGUuYWRkT3JkZXIgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICBvcmRlcnNGYWN0b3J5LmFkZE9yZGVyKHtcbiAgICAgICAgICAgIHRpdGxlOiBjdXJyZW50UHJvZHVjdC50aXRsZSxcbiAgICAgICAgICAgIGlkOiBvcmRlcnNGYWN0b3J5LmdldE9yZGVycygpLmxlbmd0aCArIDEsXG4gICAgICAgICAgICBjb3N0OiBjdXJyZW50UHJvZHVjdC5jb3N0LFxuICAgICAgICAgICAgcXVhbnRpdHk6IDFcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICRzY29wZS5kZWxldGVQcm9kdWN0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHZhciBpbmRleCA9ICRzY29wZS5wcm9kdWN0cy5pbmRleE9mKGN1cnJlbnRQcm9kdWN0KTtcbiAgICAgICAgcHJvZHVjdHNGYWN0b3J5LmRlbGV0ZVByb2R1Y3Qoe1xuICAgICAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgcHJvZHVjdDogY3VycmVudFByb2R1Y3RcbiAgICAgICAgfSk7XG4gICAgfTtcbn1dKTtcblxuc2hvcEFwcC5jb250cm9sbGVyKFwiU2hvd09yZGVyc1wiLCBbXCIkc2NvcGVcIiwgXCIkcm91dGVQYXJhbXNcIiwgXCJwcm9kdWN0c0ZhY3RvcnlcIiwgXCJvcmRlcnNGYWN0b3J5XCIsIGZ1bmN0aW9uICgkc2NvcGUsICRyb3V0ZVBhcmFtcywgcHJvZHVjdHNGYWN0b3J5LCBvcmRlcnNGYWN0b3J5KSB7XG4gICAgJHNjb3BlLnBhZ2VTdHlsZSA9ICdzaG93T3JkZXJzU3R5bGUnO1xuICAgICRzY29wZS5vcmRlcnMgPSBbXTtcbiAgICAkc2NvcGUuc3VtID0gb3JkZXJzRmFjdG9yeS5kZWZpbmVDb3N0Rm9ySXRlbXMob3JkZXJzRmFjdG9yeS5nZXRPcmRlcnMoKSk7XG4gICAgJHNjb3BlLml0ZW0gPSB7fTtcbiAgICAkc2NvcGUuc2VsZWN0ZWQgPSB7IHZhbHVlOiAwIH07XG5cbiAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICRzY29wZS5vcmRlcnMgPSBvcmRlcnNGYWN0b3J5LmdldE9yZGVycygpO1xuICAgIH07XG5cbiAgICBpbml0KCk7XG4gICAgJHNjb3BlLnJlbW92ZU9yZGVyID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaWYgKCRzY29wZS5vcmRlcnNbaXRlbV0ucXVhbnRpdHkgPiAxKSB7XG4gICAgICAgICAgICAkc2NvcGUub3JkZXJzW2l0ZW1dLnF1YW50aXR5IC09IDE7XG4gICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLm9yZGVyc1tpdGVtXS5xdWFudGl0eSA9PT0gMSkge1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVycy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pO1xuXG5zaG9wQXBwLmNvbnRyb2xsZXIoXCJhZGRQcm9kdWN0XCIsIFtcIiRzY29wZVwiLCBcInByb2R1Y3RzRmFjdG9yeVwiLCBmdW5jdGlvbiAoJHNjb3BlLCBwcm9kdWN0c0ZhY3RvcnkpIHtcbiAgICAkc2NvcGUucGFnZVN0eWxlID0gJ2FkZFN0eWxlJztcblxuICAgICRzY29wZS5hZGRQcm9kdWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBwcm9kdWN0c0ZhY3RvcnkuYWRkUHJvZHVjdCh7XG4gICAgICAgICAgICB0aXRsZTogJHNjb3BlLm5ld1Byb2R1Y3QudGl0bGUsXG4gICAgICAgICAgICBpbWc6ICRzY29wZS5uZXdQcm9kdWN0LmltZyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAkc2NvcGUubmV3UHJvZHVjdC5kZXNjLFxuICAgICAgICAgICAgZ2VucmU6ICRzY29wZS5uZXdQcm9kdWN0LmdlbnJlLFxuICAgICAgICAgICAgY29zdDogJHNjb3BlLm5ld1Byb2R1Y3QuY29zdCxcbiAgICAgICAgICAgIGlkOiBNYXRoLnJhbmRvbSgpXG4gICAgICAgIH0pO1xuICAgIH07XG59XSk7Il19
