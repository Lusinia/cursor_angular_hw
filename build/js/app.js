"use strict";var shopApp=angular.module("shopApp",["ngRoute","ngAnimate"]);shopApp.config(["$routeProvider","$locationProvider",function(t,o){t.when("/",{templateUrl:"../partials/home.html",controller:"mainController"}).when("/add",{templateUrl:"../partials/add.html",controller:"addProduct"}).when("/orders",{templateUrl:"../partials/orders.html",controller:"ShowOrders"}).when("/product/:id",{templateUrl:"../partials/product.html",controller:"ShowProduct"}).otherwise({redirectTo:"/orders"})}]),shopApp.factory("productsFactory",["$http",function(t){var o=function(){return t.get("http://localhost:8080/")},r=[],e={};return e.getJSON=function(){return o()},e.getProducts=function(){return r},e.setProducts=function(t){r=t},e.addProduct=function(o){t({method:"post",url:"http://localhost:8080/",data:JSON.stringify(o),config:"Content-Type: application/json;"}).then(function(t){console.log(t)},function(t){console.log(t)})},e.deleteProduct=function(o){var r={index:o.index,productId:o.product.id};t.delete("http://localhost:8080/product/"+r.productId,{params:r}).then(function(t){console.log(t)})},e.findProductById=function(t){var o=void 0;return r.forEach(function(r){r.id==t&&(o=r)}),o},e}]),shopApp.factory("ordersFactory",function(){var t=[{id:1,title:"Cat in the dark",img:"./img/cat2.jpg",desc:"Its just me",cost:"50",quantity:1}],o={};return o.getOrders=function(){return t},o.addOrder=function(o){if(t.length>0){var r=!1;t.forEach(function(t){o.title===t.title&&(r=!0,t.quantity++)}),r||t.push(o)}},o.defineCostForItems=function(t){var o=0;return t.forEach(function(t){o+=+t.cost}),o},o}),shopApp.controller("mainController",["$scope","$location","$routeParams","productsFactory","ordersFactory",function(t,o,r,e,n){t.pageStyle="mainPageStyle",t.pageClass="page-style",t.products=[],t.orders=[],t.item={};var c=function(){e.getJSON().then(function(o){var r=[];o.data.forEach(function(t){var o={};o.description=t.description,o.title=t.title,o.img=t.img,o.genre=t.genre,o.cost=t.cost,o.id=t.id,r.push(o)}),e.setProducts(r),t.products=r,console.log("productsFactory.getJSON()",e.getJSON())})};t.products=c(),t.orders=n.getOrders()}]),shopApp.controller("ShowProduct",["$scope","$routeParams","productsFactory","ordersFactory",function(t,o,r,e){t.pageStyle="showProductStyle",t.ProductId=o.id;var n=r.findProductById(t.ProductId);t.img=n.img,t.title=n.title,t.genre=n.genre,t.description=n.description,t.cost=n.cost,t.products=r.getProducts(),t.addOrder=function(t){e.addOrder({title:n.title,id:e.getOrders().length+1,cost:n.cost,quantity:1})},t.deleteProduct=function(){var o=t.products.indexOf(n);r.deleteProduct({index:o,product:n})}}]),shopApp.controller("ShowOrders",["$scope","$routeParams","productsFactory","ordersFactory",function(t,o,r,e){t.pageStyle="showOrdersStyle",t.orders=[],t.sum=e.defineCostForItems(e.getOrders()),t.item={},t.selected={value:0},console.log("$scope.sum",t.sum);t.orders=e.getOrders(),console.log(" $scope.orders",t.orders),t.removeOrder=function(o){t.orders[o].quantity>1?t.orders[o].quantity-=1:1===t.orders[o].quantity&&t.orders.splice(o,1)}}]),shopApp.controller("addProduct",["$scope","productsFactory",function(t,o){t.pageStyle="addStyle",t.addProduct=function(){o.addProduct({title:t.newProduct.title,img:t.newProduct.img,description:t.newProduct.desc,genre:t.newProduct.genre,cost:t.newProduct.cost,id:Math.random()})}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJzaG9wQXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsImZhY3RvcnkiLCIkaHR0cCIsInJlY2lldmVEYXRhIiwiZ2V0IiwicHJvZHVjdHMiLCJnZXRKU09OIiwiZ2V0UHJvZHVjdHMiLCJzZXRQcm9kdWN0cyIsImRhdGEiLCJhZGRQcm9kdWN0IiwiaXRlbSIsIm1ldGhvZCIsInVybCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGVuIiwicmVzcG9uc2UiLCJjb25zb2xlIiwibG9nIiwiZGVsZXRlUHJvZHVjdCIsInByb2R1Y3RJbmZvIiwiaW5kZXgiLCJwcm9kdWN0SWQiLCJwcm9kdWN0IiwiaWQiLCJkZWxldGUiLCJwYXJhbXMiLCJmaW5kUHJvZHVjdEJ5SWQiLCJmb3VuZCIsImZvckVhY2giLCJvcmRlcnMiLCJ0aXRsZSIsImltZyIsImRlc2MiLCJjb3N0IiwicXVhbnRpdHkiLCJnZXRPcmRlcnMiLCJhZGRPcmRlciIsImxlbmd0aCIsImlzQ29pbmNpZGVuY2UiLCJvcmRlciIsInB1c2giLCJkZWZpbmVDb3N0Rm9ySXRlbXMiLCJzdW0iLCIkc2NvcGUiLCIkbG9jYXRpb24iLCIkcm91dGVQYXJhbXMiLCJwcm9kdWN0c0ZhY3RvcnkiLCJvcmRlcnNGYWN0b3J5IiwicGFnZVN0eWxlIiwicGFnZUNsYXNzIiwiY3JlYXRlTGlzdCIsIml0ZW1zIiwibGlzdCIsImtleSIsImxpc3RJdGVtIiwiZGVzY3JpcHRpb24iLCJnZW5yZSIsIlByb2R1Y3RJZCIsImN1cnJlbnRQcm9kdWN0IiwiaW5kZXhPZiIsInNlbGVjdGVkIiwidmFsdWUiLCJyZW1vdmVPcmRlciIsInNwbGljZSIsIm5ld1Byb2R1Y3QiLCJNYXRoIiwicmFuZG9tIl0sIm1hcHBpbmdzIjoi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LEVBQUFkLE9BQUFwQixHQUFBeUIsVUFDQVMsRUFBQWQsT0FBQWtDLE9BQUF0RCxFQUFBLE9BS0FyQixRQUFBUSxXQUFBLGNBQUEsU0FBQSxrQkFBQSxTQUFBK0MsRUFBQUcsR0FDQUgsRUFBQUssVUFBQSxXQUVBTCxFQUFBbkMsV0FBQSxXQUNBc0MsRUFBQXRDLFlBQ0FzQixNQUFBYSxFQUFBcUIsV0FBQWxDLE1BQ0FDLElBQUFZLEVBQUFxQixXQUFBakMsSUFDQXdCLFlBQUFaLEVBQUFxQixXQUFBaEMsS0FDQXdCLE1BQUFiLEVBQUFxQixXQUFBUixNQUNBdkIsS0FBQVUsRUFBQXFCLFdBQUEvQixLQUNBVixHQUFBMEMsS0FBQUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vIGRlZmluZSBvdXIgYXBwbGljYXRpb24gYW5kIHB1bGwgaW4gbmdSb3V0ZSBhbmQgbmdBbmltYXRlXG52YXIgc2hvcEFwcCA9IGFuZ3VsYXIubW9kdWxlKFwic2hvcEFwcFwiLCBbXCJuZ1JvdXRlXCIsIFwibmdBbmltYXRlXCJdKTtcbi8vXG4vLyBST1VUSU5HID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBzZXQgb3VyIHJvdXRpbmcgZm9yIHRoaXMgYXBwbGljYXRpb25cbi8vIGVhY2ggcm91dGUgd2lsbCBwdWxsIGluIGEgZGlmZmVyZW50IGNvbnRyb2xsZXJcbnNob3BBcHAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCBmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG5cbiAgICAkcm91dGVQcm92aWRlclxuXG4gICAgLy8gaG9tZSBwYWdlXG4gICAgLndoZW4oXCIvXCIsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiLi4vcGFydGlhbHMvaG9tZS5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwibWFpbkNvbnRyb2xsZXJcIlxuICAgIH0pXG5cbiAgICAvLyBhZGQgcGFnZVxuICAgIC53aGVuKFwiL2FkZFwiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcIi4uL3BhcnRpYWxzL2FkZC5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwiYWRkUHJvZHVjdFwiXG4gICAgfSlcblxuICAgIC8vIG9yZGVycyBwYWdlXG4gICAgLndoZW4oXCIvb3JkZXJzXCIsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiLi4vcGFydGlhbHMvb3JkZXJzLmh0bWxcIixcbiAgICAgICAgY29udHJvbGxlcjogXCJTaG93T3JkZXJzXCJcbiAgICB9KVxuXG4gICAgLy8gcHJvZHVjdCBwYWdlXG4gICAgLndoZW4oXCIvcHJvZHVjdC86aWRcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCIuLi9wYXJ0aWFscy9wcm9kdWN0Lmh0bWxcIixcbiAgICAgICAgY29udHJvbGxlcjogXCJTaG93UHJvZHVjdFwiXG4gICAgfSkub3RoZXJ3aXNlKHsgcmVkaXJlY3RUbzogXCIvb3JkZXJzXCIgfSk7XG4gICAgLy8gJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xufV0pO1xuXG4vLyBGQUNUT1JZXG5zaG9wQXBwLmZhY3RvcnkoXCJwcm9kdWN0c0ZhY3RvcnlcIiwgW1wiJGh0dHBcIiwgZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgICB2YXIgcmVjaWV2ZURhdGEgPSBmdW5jdGlvbiByZWNpZXZlRGF0YSgpIHtcbiAgICAgICAgcmV0dXJuICRodHRwLmdldCgnaHR0cDovL2xvY2FsaG9zdDo4MDgwLycpO1xuICAgIH07XG4gICAgdmFyIHByb2R1Y3RzID0gW107XG5cbiAgICB2YXIgZmFjdG9yeSA9IHt9O1xuICAgIGZhY3RvcnkuZ2V0SlNPTiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHJlY2lldmVEYXRhKCk7XG4gICAgfTtcbiAgICBmYWN0b3J5LmdldFByb2R1Y3RzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gcHJvZHVjdHM7XG4gICAgfTtcbiAgICBmYWN0b3J5LnNldFByb2R1Y3RzID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgcHJvZHVjdHMgPSBkYXRhO1xuICAgIH07XG4gICAgZmFjdG9yeS5hZGRQcm9kdWN0ID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgwODAvJyxcbiAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGl0ZW0pLFxuICAgICAgICAgICAgY29uZmlnOiAnQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uOydcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgZmFjdG9yeS5kZWxldGVQcm9kdWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB2YXIgcHJvZHVjdEluZm8gPSB7XG4gICAgICAgICAgICBpbmRleDogZGF0YS5pbmRleCxcbiAgICAgICAgICAgIHByb2R1Y3RJZDogZGF0YS5wcm9kdWN0LmlkXG4gICAgICAgIH07XG4gICAgICAgICRodHRwLmRlbGV0ZSgnaHR0cDovL2xvY2FsaG9zdDo4MDgwL3Byb2R1Y3QvJyArIHByb2R1Y3RJbmZvLnByb2R1Y3RJZCwgeyBwYXJhbXM6IHByb2R1Y3RJbmZvIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgZmFjdG9yeS5maW5kUHJvZHVjdEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgdmFyIGZvdW5kID0gdm9pZCAwO1xuICAgICAgICBwcm9kdWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9kdWN0KSB7XG4gICAgICAgICAgICBpZiAocHJvZHVjdC5pZCA9PSBpZCkge1xuICAgICAgICAgICAgICAgIGZvdW5kID0gcHJvZHVjdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9O1xuICAgIHJldHVybiBmYWN0b3J5O1xufV0pO1xuXG5zaG9wQXBwLmZhY3RvcnkoXCJvcmRlcnNGYWN0b3J5XCIsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3JkZXJzID0gW3tcbiAgICAgICAgaWQ6IDEsXG4gICAgICAgIHRpdGxlOiBcIkNhdCBpbiB0aGUgZGFya1wiLFxuICAgICAgICBpbWc6ICcuL2ltZy9jYXQyLmpwZycsXG4gICAgICAgIGRlc2M6IFwiSXRzIGp1c3QgbWVcIixcbiAgICAgICAgY29zdDogJzUwJyxcbiAgICAgICAgcXVhbnRpdHk6IDFcbiAgICB9XTtcbiAgICB2YXIgZmFjdG9yeSA9IHt9O1xuICAgIGZhY3RvcnkuZ2V0T3JkZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gb3JkZXJzO1xuICAgIH07XG5cbiAgICBmYWN0b3J5LmFkZE9yZGVyID0gZnVuY3Rpb24gKGl0ZW0pIHtcblxuICAgICAgICBpZiAob3JkZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBpc0NvaW5jaWRlbmNlID0gZmFsc2U7XG4gICAgICAgICAgICBvcmRlcnMuZm9yRWFjaChmdW5jdGlvbiAob3JkZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS50aXRsZSA9PT0gb3JkZXIudGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNDb2luY2lkZW5jZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyLnF1YW50aXR5Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIWlzQ29pbmNpZGVuY2UpIHtcbiAgICAgICAgICAgICAgICBvcmRlcnMucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgZmFjdG9yeS5kZWZpbmVDb3N0Rm9ySXRlbXMgPSBmdW5jdGlvbiAob3JkZXJzKSB7XG4gICAgICAgIHZhciBzdW0gPSAwO1xuICAgICAgICBvcmRlcnMuZm9yRWFjaChmdW5jdGlvbiAob3JkZXIpIHtcbiAgICAgICAgICAgIHN1bSArPSArb3JkZXIuY29zdDtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdW07XG4gICAgfTtcbiAgICByZXR1cm4gZmFjdG9yeTtcbn0pO1xuXG4vLyBDT05UUk9MTEVSUyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gaG9tZSBwYWdlIGNvbnRyb2xsZXJcbnNob3BBcHAuY29udHJvbGxlcihcIm1haW5Db250cm9sbGVyXCIsIFtcIiRzY29wZVwiLCBcIiRsb2NhdGlvblwiLCBcIiRyb3V0ZVBhcmFtc1wiLCBcInByb2R1Y3RzRmFjdG9yeVwiLCBcIm9yZGVyc0ZhY3RvcnlcIiwgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkcm91dGVQYXJhbXMsIHByb2R1Y3RzRmFjdG9yeSwgb3JkZXJzRmFjdG9yeSkge1xuICAgICRzY29wZS5wYWdlU3R5bGUgPSAnbWFpblBhZ2VTdHlsZSc7XG4gICAgJHNjb3BlLnBhZ2VDbGFzcyA9IFwicGFnZS1zdHlsZVwiO1xuICAgICRzY29wZS5wcm9kdWN0cyA9IFtdO1xuICAgICRzY29wZS5vcmRlcnMgPSBbXTtcbiAgICAkc2NvcGUuaXRlbSA9IHt9O1xuXG4gICAgdmFyIGNyZWF0ZUxpc3QgPSBmdW5jdGlvbiBjcmVhdGVMaXN0KCkge1xuICAgICAgICBwcm9kdWN0c0ZhY3RvcnkuZ2V0SlNPTigpLnRoZW4oZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgICAgICAgaXRlbXMuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGlzdEl0ZW0gPSB7fTtcbiAgICAgICAgICAgICAgICBsaXN0SXRlbS5kZXNjcmlwdGlvbiA9IGtleS5kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICBsaXN0SXRlbS50aXRsZSA9IGtleS50aXRsZTtcbiAgICAgICAgICAgICAgICBsaXN0SXRlbS5pbWcgPSBrZXkuaW1nO1xuICAgICAgICAgICAgICAgIGxpc3RJdGVtLmdlbnJlID0ga2V5LmdlbnJlO1xuICAgICAgICAgICAgICAgIGxpc3RJdGVtLmNvc3QgPSBrZXkuY29zdDtcbiAgICAgICAgICAgICAgICBsaXN0SXRlbS5pZCA9IGtleS5pZDtcbiAgICAgICAgICAgICAgICBsaXN0LnB1c2gobGlzdEl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwcm9kdWN0c0ZhY3Rvcnkuc2V0UHJvZHVjdHMobGlzdCk7XG4gICAgICAgICAgICAkc2NvcGUucHJvZHVjdHMgPSBsaXN0O1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3Byb2R1Y3RzRmFjdG9yeS5nZXRKU09OKCknLCBwcm9kdWN0c0ZhY3RvcnkuZ2V0SlNPTigpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciBpbml0ID0gZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgJHNjb3BlLnByb2R1Y3RzID0gY3JlYXRlTGlzdCgpO1xuICAgICAgICAkc2NvcGUub3JkZXJzID0gb3JkZXJzRmFjdG9yeS5nZXRPcmRlcnMoKTtcbiAgICB9O1xuXG4gICAgaW5pdCgpO1xufV0pO1xuc2hvcEFwcC5jb250cm9sbGVyKFwiU2hvd1Byb2R1Y3RcIiwgW1wiJHNjb3BlXCIsIFwiJHJvdXRlUGFyYW1zXCIsIFwicHJvZHVjdHNGYWN0b3J5XCIsIFwib3JkZXJzRmFjdG9yeVwiLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm91dGVQYXJhbXMsIHByb2R1Y3RzRmFjdG9yeSwgb3JkZXJzRmFjdG9yeSkge1xuICAgICRzY29wZS5wYWdlU3R5bGUgPSAnc2hvd1Byb2R1Y3RTdHlsZSc7XG4gICAgJHNjb3BlLlByb2R1Y3RJZCA9ICRyb3V0ZVBhcmFtcy5pZDtcbiAgICB2YXIgY3VycmVudFByb2R1Y3QgPSBwcm9kdWN0c0ZhY3RvcnkuZmluZFByb2R1Y3RCeUlkKCRzY29wZS5Qcm9kdWN0SWQpO1xuICAgICRzY29wZS5pbWcgPSBjdXJyZW50UHJvZHVjdC5pbWc7XG4gICAgJHNjb3BlLnRpdGxlID0gY3VycmVudFByb2R1Y3QudGl0bGU7XG4gICAgJHNjb3BlLmdlbnJlID0gY3VycmVudFByb2R1Y3QuZ2VucmU7XG4gICAgJHNjb3BlLmRlc2NyaXB0aW9uID0gY3VycmVudFByb2R1Y3QuZGVzY3JpcHRpb247XG4gICAgJHNjb3BlLmNvc3QgPSBjdXJyZW50UHJvZHVjdC5jb3N0O1xuXG4gICAgJHNjb3BlLnByb2R1Y3RzID0gcHJvZHVjdHNGYWN0b3J5LmdldFByb2R1Y3RzKCk7XG4gICAgLy8gY29uc29sZS5sb2coJ2N1cnJlbnRQcm9kdWN0JywgY3VycmVudFByb2R1Y3QpO1xuXG4gICAgJHNjb3BlLmFkZE9yZGVyID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgb3JkZXJzRmFjdG9yeS5hZGRPcmRlcih7XG4gICAgICAgICAgICB0aXRsZTogY3VycmVudFByb2R1Y3QudGl0bGUsXG4gICAgICAgICAgICBpZDogb3JkZXJzRmFjdG9yeS5nZXRPcmRlcnMoKS5sZW5ndGggKyAxLFxuICAgICAgICAgICAgY29zdDogY3VycmVudFByb2R1Y3QuY29zdCxcbiAgICAgICAgICAgIHF1YW50aXR5OiAxXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLmRlbGV0ZVByb2R1Y3QgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIGluZGV4ID0gJHNjb3BlLnByb2R1Y3RzLmluZGV4T2YoY3VycmVudFByb2R1Y3QpO1xuICAgICAgICBwcm9kdWN0c0ZhY3RvcnkuZGVsZXRlUHJvZHVjdCh7XG4gICAgICAgICAgICBpbmRleDogaW5kZXgsXG4gICAgICAgICAgICBwcm9kdWN0OiBjdXJyZW50UHJvZHVjdFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gJHNjb3BlLnByb2R1Y3RzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdpbmRleCcsIGluZGV4KTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3Byb2R1Y3RzJywgcHJvZHVjdHMpO1xuICAgIH07XG59XSk7XG5cbnNob3BBcHAuY29udHJvbGxlcihcIlNob3dPcmRlcnNcIiwgW1wiJHNjb3BlXCIsIFwiJHJvdXRlUGFyYW1zXCIsIFwicHJvZHVjdHNGYWN0b3J5XCIsIFwib3JkZXJzRmFjdG9yeVwiLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm91dGVQYXJhbXMsIHByb2R1Y3RzRmFjdG9yeSwgb3JkZXJzRmFjdG9yeSkge1xuICAgICRzY29wZS5wYWdlU3R5bGUgPSAnc2hvd09yZGVyc1N0eWxlJztcbiAgICAkc2NvcGUub3JkZXJzID0gW107XG4gICAgJHNjb3BlLnN1bSA9IG9yZGVyc0ZhY3RvcnkuZGVmaW5lQ29zdEZvckl0ZW1zKG9yZGVyc0ZhY3RvcnkuZ2V0T3JkZXJzKCkpO1xuICAgICRzY29wZS5pdGVtID0ge307XG4gICAgJHNjb3BlLnNlbGVjdGVkID0geyB2YWx1ZTogMCB9O1xuICAgIGNvbnNvbGUubG9nKCckc2NvcGUuc3VtJywgJHNjb3BlLnN1bSk7XG5cbiAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICRzY29wZS5vcmRlcnMgPSBvcmRlcnNGYWN0b3J5LmdldE9yZGVycygpO1xuICAgICAgICBjb25zb2xlLmxvZygnICRzY29wZS5vcmRlcnMnLCAkc2NvcGUub3JkZXJzKTtcbiAgICB9O1xuXG4gICAgaW5pdCgpO1xuICAgICRzY29wZS5yZW1vdmVPcmRlciA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGlmICgkc2NvcGUub3JkZXJzW2l0ZW1dLnF1YW50aXR5ID4gMSkge1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVyc1tpdGVtXS5xdWFudGl0eSAtPSAxO1xuICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5vcmRlcnNbaXRlbV0ucXVhbnRpdHkgPT09IDEpIHtcbiAgICAgICAgICAgICRzY29wZS5vcmRlcnMuc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKTtcblxuc2hvcEFwcC5jb250cm9sbGVyKFwiYWRkUHJvZHVjdFwiLCBbXCIkc2NvcGVcIiwgXCJwcm9kdWN0c0ZhY3RvcnlcIiwgZnVuY3Rpb24gKCRzY29wZSwgcHJvZHVjdHNGYWN0b3J5KSB7XG4gICAgJHNjb3BlLnBhZ2VTdHlsZSA9ICdhZGRTdHlsZSc7XG5cbiAgICAkc2NvcGUuYWRkUHJvZHVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcHJvZHVjdHNGYWN0b3J5LmFkZFByb2R1Y3Qoe1xuICAgICAgICAgICAgdGl0bGU6ICRzY29wZS5uZXdQcm9kdWN0LnRpdGxlLFxuICAgICAgICAgICAgaW1nOiAkc2NvcGUubmV3UHJvZHVjdC5pbWcsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJHNjb3BlLm5ld1Byb2R1Y3QuZGVzYyxcbiAgICAgICAgICAgIGdlbnJlOiAkc2NvcGUubmV3UHJvZHVjdC5nZW5yZSxcbiAgICAgICAgICAgIGNvc3Q6ICRzY29wZS5uZXdQcm9kdWN0LmNvc3QsXG4gICAgICAgICAgICBpZDogTWF0aC5yYW5kb20oKVxuICAgICAgICB9KTtcbiAgICB9O1xufV0pOyJdfQ==
