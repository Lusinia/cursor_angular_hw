"use strict";var shopApp=angular.module("shopApp",["ngRoute","ngAnimate"]);shopApp.config(["$routeProvider","$locationProvider",function(t,o){t.when("/",{templateUrl:"../partials/home.html",controller:"mainController"}).when("/add",{templateUrl:"../partials/add.html",controller:"addProduct"}).when("/orders",{templateUrl:"../partials/orders.html",controller:"ShowOrders"}).when("/product/:id",{templateUrl:"../partials/product.html",controller:"ShowProduct"}).otherwise({redirectTo:"/orders"}),o.html5Mode(!0)}]),shopApp.factory("ordersFactory",function(){var t=[{id:1,title:"Cat in the dark",img:"./img/cat2.jpg",desc:"Its just me",cost:"50",quantity:1}],o={};return o.getOrders=function(){return t},o.addOrder=function(o){if(t.length>0){var r=!1;t.forEach(function(t){o.title===t.title&&(r=!0,t.quantity++)}),r||t.push(o)}},o.defineCostForItems=function(t){var o=0;return t.forEach(function(t){o+=+t.cost}),o},o}),shopApp.factory("productsFactory",["$http","$location",function(t,o){var r=function(){return t.get("http://localhost:8080/")},e=[],n={};return n.getJSON=function(){return r()},n.getProducts=function(){return e},n.setProducts=function(t){e=t},n.addProduct=function(r){t({method:"post",url:"http://localhost:8080/",data:JSON.stringify(r),config:"Content-Type: application/json;"}).then(function(t){console.log(t),o.path("/")},function(t){console.log(t)})},n.deleteProduct=function(o){var r={index:o.index,productId:o.product.id};t.delete("http://localhost:8080/product/"+r.productId,{params:r}).then(function(t){console.log(t)})},n.findProductById=function(t){var o=void 0;return e.forEach(function(r){r.id==t&&(o=r)}),o},n}]),shopApp.controller("ShowOrders",["$scope","$routeParams","productsFactory","ordersFactory",function(t,o,r,e){t.pageStyle="showOrdersStyle",t.orders=[],t.sum=e.defineCostForItems(e.getOrders()),t.item={},t.selected={value:0};t.orders=e.getOrders(),t.removeOrder=function(o){t.orders[o].quantity>1?t.orders[o].quantity-=1:1===t.orders[o].quantity&&t.orders.splice(o,1)}}]),shopApp.controller("ShowProduct",["$scope","$routeParams","productsFactory","ordersFactory",function(t,o,r,e){t.pageStyle="showProductStyle",t.ProductId=o.id;var n=r.findProductById(t.ProductId);t.img=n.img,t.title=n.title,t.genre=n.genre,t.description=n.description,t.cost=n.cost,t.products=r.getProducts(),t.addOrder=function(t){e.addOrder({title:n.title,id:e.getOrders().length+1,cost:n.cost,quantity:1})},t.deleteProduct=function(){var o=t.products.indexOf(n);r.deleteProduct({index:o,product:n})}}]),shopApp.controller("addProduct",["$scope","productsFactory",function(t,o){t.pageStyle="addStyle",t.addProduct=function(){o.addProduct({title:t.newProduct.title,img:t.newProduct.img,description:t.newProduct.desc,genre:t.newProduct.genre,cost:t.newProduct.cost,id:Math.random()})}}]),shopApp.controller("mainController",["$scope","$location","$routeParams","productsFactory","ordersFactory",function(t,o,r,e,n){t.pageStyle="mainPageStyle",t.pageClass="page-style",t.products=[],t.orders=[],t.item={};var d=function(){e.getJSON().then(function(o){var r=[];o.data.forEach(function(t){var o={};o.description=t.description,o.title=t.title,o.img=t.img,o.genre=t.genre,o.cost=t.cost,o.id=t.id,r.push(o)}),e.setProducts(r),t.products=r})};t.products=d(),t.orders=n.getOrders()}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIm9yZGVycy5qcyIsInByb2R1Y3RzLmpzIiwiU2hvd09yZGVycy5qcyIsIlNob3dQcm9kdWN0LmpzIiwiYWRkUHJvZHVjdC5qcyIsIm1haW5Db250cm9sbGVyLmpzIl0sIm5hbWVzIjpbInNob3BBcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiaHRtbDVNb2RlIiwiZmFjdG9yeSIsIm9yZGVycyIsImlkIiwidGl0bGUiLCJpbWciLCJkZXNjIiwiY29zdCIsInF1YW50aXR5IiwiZ2V0T3JkZXJzIiwiYWRkT3JkZXIiLCJpdGVtIiwibGVuZ3RoIiwiaXNDb2luY2lkZW5jZSIsImZvckVhY2giLCJvcmRlciIsInB1c2giLCJkZWZpbmVDb3N0Rm9ySXRlbXMiLCJzdW0iLCIkaHR0cCIsIiRsb2NhdGlvbiIsInJlY2lldmVEYXRhIiwiZ2V0IiwicHJvZHVjdHMiLCJnZXRKU09OIiwiZ2V0UHJvZHVjdHMiLCJzZXRQcm9kdWN0cyIsImRhdGEiLCJhZGRQcm9kdWN0IiwibWV0aG9kIiwidXJsIiwiSlNPTiIsInN0cmluZ2lmeSIsInRoZW4iLCJyZXNwb25zZSIsImNvbnNvbGUiLCJsb2ciLCJwYXRoIiwiZGVsZXRlUHJvZHVjdCIsInByb2R1Y3RJbmZvIiwiaW5kZXgiLCJwcm9kdWN0SWQiLCJwcm9kdWN0IiwiZGVsZXRlIiwicGFyYW1zIiwiZmluZFByb2R1Y3RCeUlkIiwiZm91bmQiLCIkc2NvcGUiLCIkcm91dGVQYXJhbXMiLCJwcm9kdWN0c0ZhY3RvcnkiLCJvcmRlcnNGYWN0b3J5IiwicGFnZVN0eWxlIiwic2VsZWN0ZWQiLCJ2YWx1ZSIsInJlbW92ZU9yZGVyIiwic3BsaWNlIiwiUHJvZHVjdElkIiwiY3VycmVudFByb2R1Y3QiLCJnZW5yZSIsImRlc2NyaXB0aW9uIiwiaW5kZXhPZiIsIm5ld1Byb2R1Y3QiLCJNYXRoIiwicmFuZG9tIiwicGFnZUNsYXNzIiwiY3JlYXRlTGlzdCIsIml0ZW1zIiwibGlzdCIsImtleSIsImxpc3RJdGVtIl0sIm1hcHBpbmdzIjoiQUFBQSxhQUdBLElBQUFBLFFBQUFDLFFBQUFDLE9BQUEsV0FBQSxVQUFBLGNBS0FGLFFBQUFHLFFBQUEsaUJBQUEsb0JBQUEsU0FBQUMsRUFBQUMsR0FFQUQsRUFHQUUsS0FBQSxLQUNBQyxZQUFBLHdCQUNBQyxXQUFBLG1CQUlBRixLQUFBLFFBQ0FDLFlBQUEsdUJBQ0FDLFdBQUEsZUFJQUYsS0FBQSxXQUNBQyxZQUFBLDBCQUNBQyxXQUFBLGVBSUFGLEtBQUEsZ0JBQ0FDLFlBQUEsMkJBQ0FDLFdBQUEsZ0JBQ0FDLFdBQUFDLFdBQUEsWUFDQUwsRUFBQU0sV0FBQSxNQ2hDQVgsUUFBQVksUUFBQSxnQkFBQSxXQUNBLElBQUFDLElBQ0FDLEdBQUEsRUFDQUMsTUFBQSxrQkFDQUMsSUFBQSxpQkFDQUMsS0FBQSxjQUNBQyxLQUFBLEtBQ0FDLFNBQUEsSUFFQVAsS0EyQkEsT0ExQkFBLEVBQUFRLFVBQUEsV0FDQSxPQUFBUCxHQUdBRCxFQUFBUyxTQUFBLFNBQUFDLEdBRUEsR0FBQVQsRUFBQVUsT0FBQSxFQUFBLENBQ0EsSUFBQUMsR0FBQSxFQUNBWCxFQUFBWSxRQUFBLFNBQUFDLEdBQ0FKLEVBQUFQLFFBQUFXLEVBQUFYLFFBQ0FTLEdBQUEsRUFDQUUsRUFBQVAsY0FHQUssR0FDQVgsRUFBQWMsS0FBQUwsS0FJQVYsRUFBQWdCLG1CQUFBLFNBQUFmLEdBQ0EsSUFBQWdCLEVBQUEsRUFJQSxPQUhBaEIsRUFBQVksUUFBQSxTQUFBQyxHQUNBRyxJQUFBSCxFQUFBUixPQUVBVyxHQUVBakIsSUNuQ0FaLFFBQUFZLFFBQUEsbUJBQUEsUUFBQSxZQUFBLFNBQUFrQixFQUFBQyxHQUVBLElBQUFDLEVBQUEsV0FDQSxPQUFBRixFQUFBRyxJQUFBLDJCQUVBQyxLQUVBdEIsS0EyQ0EsT0ExQ0FBLEVBQUF1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LFlBQ0F3QixFQUFBN0MsVUFDQTZDLEVBQUFwQyxRQUVBLElBQUFzRCxFQUFBLFdBQ0FoQixFQUFBekIsVUFBQVMsS0FBQSxTQUFBaUMsR0FDQSxJQUFBQyxLQUNBRCxFQUFBdkMsS0FBQWIsUUFBQSxTQUFBc0QsR0FDQSxJQUFBQyxLQUNBQSxFQUFBVixZQUFBUyxFQUFBVCxZQUNBVSxFQUFBakUsTUFBQWdFLEVBQUFoRSxNQUNBaUUsRUFBQWhFLElBQUErRCxFQUFBL0QsSUFDQWdFLEVBQUFYLE1BQUFVLEVBQUFWLE1BQ0FXLEVBQUE5RCxLQUFBNkQsRUFBQTdELEtBQ0E4RCxFQUFBbEUsR0FBQWlFLEVBQUFqRSxHQUNBZ0UsRUFBQW5ELEtBQUFxRCxLQUVBcEIsRUFBQXZCLFlBQUF5QyxHQUNBcEIsRUFBQXhCLFNBQUE0QyxLQUtBcEIsRUFBQXhCLFNBQUEwQyxJQUNBbEIsRUFBQTdDLE9BQUFnRCxFQUFBekMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vIGRlZmluZSBvdXIgYXBwbGljYXRpb24gYW5kIHB1bGwgaW4gbmdSb3V0ZSBhbmQgbmdBbmltYXRlXG52YXIgc2hvcEFwcCA9IGFuZ3VsYXIubW9kdWxlKFwic2hvcEFwcFwiLCBbXCJuZ1JvdXRlXCIsIFwibmdBbmltYXRlXCJdKTtcbi8vXG4vLyBST1VUSU5HID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBzZXQgb3VyIHJvdXRpbmcgZm9yIHRoaXMgYXBwbGljYXRpb25cbi8vIGVhY2ggcm91dGUgd2lsbCBwdWxsIGluIGEgZGlmZmVyZW50IGNvbnRyb2xsZXJcbnNob3BBcHAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCBmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG5cbiAgICAkcm91dGVQcm92aWRlclxuXG4gICAgLy8gaG9tZSBwYWdlXG4gICAgLndoZW4oXCIvXCIsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiLi4vcGFydGlhbHMvaG9tZS5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwibWFpbkNvbnRyb2xsZXJcIlxuICAgIH0pXG5cbiAgICAvLyBhZGQgcGFnZVxuICAgIC53aGVuKFwiL2FkZFwiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcIi4uL3BhcnRpYWxzL2FkZC5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwiYWRkUHJvZHVjdFwiXG4gICAgfSlcblxuICAgIC8vIG9yZGVycyBwYWdlXG4gICAgLndoZW4oXCIvb3JkZXJzXCIsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiLi4vcGFydGlhbHMvb3JkZXJzLmh0bWxcIixcbiAgICAgICAgY29udHJvbGxlcjogXCJTaG93T3JkZXJzXCJcbiAgICB9KVxuXG4gICAgLy8gcHJvZHVjdCBwYWdlXG4gICAgLndoZW4oXCIvcHJvZHVjdC86aWRcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCIuLi9wYXJ0aWFscy9wcm9kdWN0Lmh0bWxcIixcbiAgICAgICAgY29udHJvbGxlcjogXCJTaG93UHJvZHVjdFwiXG4gICAgfSkub3RoZXJ3aXNlKHsgcmVkaXJlY3RUbzogXCIvb3JkZXJzXCIgfSk7XG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xufV0pOyIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIHNob3BBcHAuZmFjdG9yeShcIm9yZGVyc0ZhY3RvcnlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgb3JkZXJzID0gW3tcbiAgICAgICAgICAgIGlkOiAxLFxuICAgICAgICAgICAgdGl0bGU6IFwiQ2F0IGluIHRoZSBkYXJrXCIsXG4gICAgICAgICAgICBpbWc6ICcuL2ltZy9jYXQyLmpwZycsXG4gICAgICAgICAgICBkZXNjOiBcIkl0cyBqdXN0IG1lXCIsXG4gICAgICAgICAgICBjb3N0OiAnNTAnLFxuICAgICAgICAgICAgcXVhbnRpdHk6IDFcbiAgICAgICAgfV07XG4gICAgICAgIHZhciBmYWN0b3J5ID0ge307XG4gICAgICAgIGZhY3RvcnkuZ2V0T3JkZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG9yZGVycztcbiAgICAgICAgfTtcblxuICAgICAgICBmYWN0b3J5LmFkZE9yZGVyID0gZnVuY3Rpb24gKGl0ZW0pIHtcblxuICAgICAgICAgICAgaWYgKG9yZGVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlzQ29pbmNpZGVuY2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBvcmRlcnMuZm9yRWFjaChmdW5jdGlvbiAob3JkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0udGl0bGUgPT09IG9yZGVyLnRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc0NvaW5jaWRlbmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLnF1YW50aXR5Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzQ29pbmNpZGVuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJzLnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmYWN0b3J5LmRlZmluZUNvc3RGb3JJdGVtcyA9IGZ1bmN0aW9uIChvcmRlcnMpIHtcbiAgICAgICAgICAgIHZhciBzdW0gPSAwO1xuICAgICAgICAgICAgb3JkZXJzLmZvckVhY2goZnVuY3Rpb24gKG9yZGVyKSB7XG4gICAgICAgICAgICAgICAgc3VtICs9ICtvcmRlci5jb3N0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gc3VtO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZmFjdG9yeTtcbiAgICB9KTtcbn0pKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgLy8gRkFDVE9SWVxuICAgIHNob3BBcHAuZmFjdG9yeShcInByb2R1Y3RzRmFjdG9yeVwiLCBbXCIkaHR0cFwiLCBcIiRsb2NhdGlvblwiLCBmdW5jdGlvbiAoJGh0dHAsICRsb2NhdGlvbikge1xuXG4gICAgICAgIHZhciByZWNpZXZlRGF0YSA9IGZ1bmN0aW9uIHJlY2lldmVEYXRhKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnaHR0cDovL2xvY2FsaG9zdDo4MDgwLycpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgcHJvZHVjdHMgPSBbXTtcblxuICAgICAgICB2YXIgZmFjdG9yeSA9IHt9O1xuICAgICAgICBmYWN0b3J5LmdldEpTT04gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVjaWV2ZURhdGEoKTtcbiAgICAgICAgfTtcbiAgICAgICAgZmFjdG9yeS5nZXRQcm9kdWN0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9kdWN0cztcbiAgICAgICAgfTtcbiAgICAgICAgZmFjdG9yeS5zZXRQcm9kdWN0cyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwcm9kdWN0cyA9IGRhdGE7XG4gICAgICAgIH07XG4gICAgICAgIGZhY3RvcnkuYWRkUHJvZHVjdCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MDgwLycsXG4gICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoaXRlbSksXG4gICAgICAgICAgICAgICAgY29uZmlnOiAnQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uOydcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgZmFjdG9yeS5kZWxldGVQcm9kdWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgdmFyIHByb2R1Y3RJbmZvID0ge1xuICAgICAgICAgICAgICAgIGluZGV4OiBkYXRhLmluZGV4LFxuICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogZGF0YS5wcm9kdWN0LmlkXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgJGh0dHAuZGVsZXRlKCdodHRwOi8vbG9jYWxob3N0OjgwODAvcHJvZHVjdC8nICsgcHJvZHVjdEluZm8ucHJvZHVjdElkLCB7IHBhcmFtczogcHJvZHVjdEluZm8gfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZmFjdG9yeS5maW5kUHJvZHVjdEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgIHZhciBmb3VuZCA9IHZvaWQgMDtcbiAgICAgICAgICAgIHByb2R1Y3RzLmZvckVhY2goZnVuY3Rpb24gKHByb2R1Y3QpIHtcbiAgICAgICAgICAgICAgICBpZiAocHJvZHVjdC5pZCA9PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHByb2R1Y3Q7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBmYWN0b3J5O1xuICAgIH1dKTtcbn0pKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgc2hvcEFwcC5jb250cm9sbGVyKFwiU2hvd09yZGVyc1wiLCBbXCIkc2NvcGVcIiwgXCIkcm91dGVQYXJhbXNcIiwgXCJwcm9kdWN0c0ZhY3RvcnlcIiwgXCJvcmRlcnNGYWN0b3J5XCIsIGZ1bmN0aW9uICgkc2NvcGUsICRyb3V0ZVBhcmFtcywgcHJvZHVjdHNGYWN0b3J5LCBvcmRlcnNGYWN0b3J5KSB7XG4gICAgICAgICRzY29wZS5wYWdlU3R5bGUgPSAnc2hvd09yZGVyc1N0eWxlJztcbiAgICAgICAgJHNjb3BlLm9yZGVycyA9IFtdO1xuICAgICAgICAkc2NvcGUuc3VtID0gb3JkZXJzRmFjdG9yeS5kZWZpbmVDb3N0Rm9ySXRlbXMob3JkZXJzRmFjdG9yeS5nZXRPcmRlcnMoKSk7XG4gICAgICAgICRzY29wZS5pdGVtID0ge307XG4gICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHsgdmFsdWU6IDAgfTtcblxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAkc2NvcGUub3JkZXJzID0gb3JkZXJzRmFjdG9yeS5nZXRPcmRlcnMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBpbml0KCk7XG4gICAgICAgICRzY29wZS5yZW1vdmVPcmRlciA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLm9yZGVyc1tpdGVtXS5xdWFudGl0eSA+IDEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUub3JkZXJzW2l0ZW1dLnF1YW50aXR5IC09IDE7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5vcmRlcnNbaXRlbV0ucXVhbnRpdHkgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUub3JkZXJzLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XSk7XG59KSgpOyIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIHNob3BBcHAuY29udHJvbGxlcihcIlNob3dQcm9kdWN0XCIsIFtcIiRzY29wZVwiLCBcIiRyb3V0ZVBhcmFtc1wiLCBcInByb2R1Y3RzRmFjdG9yeVwiLCBcIm9yZGVyc0ZhY3RvcnlcIiwgZnVuY3Rpb24gKCRzY29wZSwgJHJvdXRlUGFyYW1zLCBwcm9kdWN0c0ZhY3RvcnksIG9yZGVyc0ZhY3RvcnkpIHtcbiAgICAgICAgJHNjb3BlLnBhZ2VTdHlsZSA9ICdzaG93UHJvZHVjdFN0eWxlJztcbiAgICAgICAgJHNjb3BlLlByb2R1Y3RJZCA9ICRyb3V0ZVBhcmFtcy5pZDtcbiAgICAgICAgdmFyIGN1cnJlbnRQcm9kdWN0ID0gcHJvZHVjdHNGYWN0b3J5LmZpbmRQcm9kdWN0QnlJZCgkc2NvcGUuUHJvZHVjdElkKTtcbiAgICAgICAgJHNjb3BlLmltZyA9IGN1cnJlbnRQcm9kdWN0LmltZztcbiAgICAgICAgJHNjb3BlLnRpdGxlID0gY3VycmVudFByb2R1Y3QudGl0bGU7XG4gICAgICAgICRzY29wZS5nZW5yZSA9IGN1cnJlbnRQcm9kdWN0LmdlbnJlO1xuICAgICAgICAkc2NvcGUuZGVzY3JpcHRpb24gPSBjdXJyZW50UHJvZHVjdC5kZXNjcmlwdGlvbjtcbiAgICAgICAgJHNjb3BlLmNvc3QgPSBjdXJyZW50UHJvZHVjdC5jb3N0O1xuICAgICAgICAkc2NvcGUucHJvZHVjdHMgPSBwcm9kdWN0c0ZhY3RvcnkuZ2V0UHJvZHVjdHMoKTtcblxuICAgICAgICAkc2NvcGUuYWRkT3JkZXIgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgb3JkZXJzRmFjdG9yeS5hZGRPcmRlcih7XG4gICAgICAgICAgICAgICAgdGl0bGU6IGN1cnJlbnRQcm9kdWN0LnRpdGxlLFxuICAgICAgICAgICAgICAgIGlkOiBvcmRlcnNGYWN0b3J5LmdldE9yZGVycygpLmxlbmd0aCArIDEsXG4gICAgICAgICAgICAgICAgY29zdDogY3VycmVudFByb2R1Y3QuY29zdCxcbiAgICAgICAgICAgICAgICBxdWFudGl0eTogMVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmRlbGV0ZVByb2R1Y3QgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIHZhciBpbmRleCA9ICRzY29wZS5wcm9kdWN0cy5pbmRleE9mKGN1cnJlbnRQcm9kdWN0KTtcbiAgICAgICAgICAgIHByb2R1Y3RzRmFjdG9yeS5kZWxldGVQcm9kdWN0KHtcbiAgICAgICAgICAgICAgICBpbmRleDogaW5kZXgsXG4gICAgICAgICAgICAgICAgcHJvZHVjdDogY3VycmVudFByb2R1Y3RcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH1dKTtcbn0pKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgc2hvcEFwcC5jb250cm9sbGVyKFwiYWRkUHJvZHVjdFwiLCBbXCIkc2NvcGVcIiwgXCJwcm9kdWN0c0ZhY3RvcnlcIiwgZnVuY3Rpb24gKCRzY29wZSwgcHJvZHVjdHNGYWN0b3J5KSB7XG4gICAgICAgICRzY29wZS5wYWdlU3R5bGUgPSAnYWRkU3R5bGUnO1xuXG4gICAgICAgICRzY29wZS5hZGRQcm9kdWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcHJvZHVjdHNGYWN0b3J5LmFkZFByb2R1Y3Qoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiAkc2NvcGUubmV3UHJvZHVjdC50aXRsZSxcbiAgICAgICAgICAgICAgICBpbWc6ICRzY29wZS5uZXdQcm9kdWN0LmltZyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJHNjb3BlLm5ld1Byb2R1Y3QuZGVzYyxcbiAgICAgICAgICAgICAgICBnZW5yZTogJHNjb3BlLm5ld1Byb2R1Y3QuZ2VucmUsXG4gICAgICAgICAgICAgICAgY29zdDogJHNjb3BlLm5ld1Byb2R1Y3QuY29zdCxcbiAgICAgICAgICAgICAgICBpZDogTWF0aC5yYW5kb20oKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgfV0pO1xufSkoKTsiLCJcInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcblxuICAgIC8vIENPTlRST0xMRVJTID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgLy8gaG9tZSBwYWdlIGNvbnRyb2xsZXJcbiAgICBzaG9wQXBwLmNvbnRyb2xsZXIoXCJtYWluQ29udHJvbGxlclwiLCBbXCIkc2NvcGVcIiwgXCIkbG9jYXRpb25cIiwgXCIkcm91dGVQYXJhbXNcIiwgXCJwcm9kdWN0c0ZhY3RvcnlcIiwgXCJvcmRlcnNGYWN0b3J5XCIsIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgJHJvdXRlUGFyYW1zLCBwcm9kdWN0c0ZhY3RvcnksIG9yZGVyc0ZhY3RvcnkpIHtcbiAgICAgICAgJHNjb3BlLnBhZ2VTdHlsZSA9ICdtYWluUGFnZVN0eWxlJztcbiAgICAgICAgJHNjb3BlLnBhZ2VDbGFzcyA9IFwicGFnZS1zdHlsZVwiO1xuICAgICAgICAkc2NvcGUucHJvZHVjdHMgPSBbXTtcbiAgICAgICAgJHNjb3BlLm9yZGVycyA9IFtdO1xuICAgICAgICAkc2NvcGUuaXRlbSA9IHt9O1xuXG4gICAgICAgIHZhciBjcmVhdGVMaXN0ID0gZnVuY3Rpb24gY3JlYXRlTGlzdCgpIHtcbiAgICAgICAgICAgIHByb2R1Y3RzRmFjdG9yeS5nZXRKU09OKCkudGhlbihmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIGl0ZW1zLmRhdGEuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaXN0SXRlbSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBsaXN0SXRlbS5kZXNjcmlwdGlvbiA9IGtleS5kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgbGlzdEl0ZW0udGl0bGUgPSBrZXkudGl0bGU7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RJdGVtLmltZyA9IGtleS5pbWc7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RJdGVtLmdlbnJlID0ga2V5LmdlbnJlO1xuICAgICAgICAgICAgICAgICAgICBsaXN0SXRlbS5jb3N0ID0ga2V5LmNvc3Q7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RJdGVtLmlkID0ga2V5LmlkO1xuICAgICAgICAgICAgICAgICAgICBsaXN0LnB1c2gobGlzdEl0ZW0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHByb2R1Y3RzRmFjdG9yeS5zZXRQcm9kdWN0cyhsaXN0KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvZHVjdHMgPSBsaXN0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3RzID0gY3JlYXRlTGlzdCgpO1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVycyA9IG9yZGVyc0ZhY3RvcnkuZ2V0T3JkZXJzKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdCgpO1xuICAgIH1dKTtcbn0pKCk7Il19
