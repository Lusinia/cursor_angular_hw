"use strict";var shopApp=angular.module("shopApp",["ngRoute"]);shopApp.config(["$routeProvider","$locationProvider",function(t,o){t.when("/",{templateUrl:"../partials/home.html",controller:"mainController"}).when("/add",{templateUrl:"../partials/add.html",controller:"addProduct"}).when("/orders",{templateUrl:"../partials/orders.html",controller:"ShowOrders"}).when("/product/:id",{templateUrl:"../partials/product.html",controller:"ShowProduct"}).otherwise({redirectTo:"/orders"}),o.html5Mode(!0)}]),shopApp.factory("ordersFactory",function(){var t=[{id:1,title:"Cat in the dark",img:"./img/cat2.jpg",desc:"Its just me",cost:"50",quantity:1}],o={};return o.getOrders=function(){return t},o.addOrder=function(o){if(t.length>0){var r=!1;t.forEach(function(t){o.title===t.title&&(r=!0,t.quantity++)}),r||t.push(o)}},o.defineCostForItems=function(t){var o=0;return t.forEach(function(t){o+=+t.cost}),o},o}),shopApp.factory("productsFactory",["$http","$location",function(t,o){var r=function(){return t.get("http://localhost:8080/")},e=[],n={};return n.getJSON=function(){return r()},n.getProducts=function(){return e},n.setProducts=function(t){e=t},n.addProduct=function(r){t({method:"post",url:"http://localhost:8080/",data:JSON.stringify(r),config:"Content-Type: application/json;"}).then(function(t){console.log(t),o.path("/")},function(t){console.log(t)})},n.deleteProduct=function(o){var r={index:o.index,productId:o.product.id};t.delete("http://localhost:8080/product/"+r.productId,{params:r}).then(function(t){console.log(t)})},n.findProductById=function(t){var o=void 0;return e.forEach(function(r){r.id==t&&(o=r)}),o},n}]),shopApp.controller("ShowOrders",["$scope","$routeParams","productsFactory","ordersFactory",function(t,o,r,e){t.pageStyle="showOrdersStyle",t.orders=[],t.sum=e.defineCostForItems(e.getOrders()),t.item={},t.selected={value:0};t.orders=e.getOrders(),t.removeOrder=function(o){t.orders[o].quantity>1?t.orders[o].quantity-=1:1===t.orders[o].quantity&&t.orders.splice(o,1)}}]),shopApp.controller("ShowProduct",["$scope","$routeParams","productsFactory","ordersFactory",function(t,o,r,e){t.pageStyle="showProductStyle",t.ProductId=o.id;var n=r.findProductById(t.ProductId);t.img=n.img,t.title=n.title,t.genre=n.genre,t.description=n.description,t.cost=n.cost,t.products=r.getProducts(),t.addOrder=function(t){e.addOrder({title:n.title,id:e.getOrders().length+1,cost:n.cost,quantity:1})},t.deleteProduct=function(){var o=t.products.indexOf(n);r.deleteProduct({index:o,product:n})}}]),shopApp.controller("addProduct",["$scope","productsFactory",function(t,o){t.pageStyle="addStyle",t.addProduct=function(){o.addProduct({title:t.newProduct.title,img:t.newProduct.img,description:t.newProduct.desc,genre:t.newProduct.genre,cost:t.newProduct.cost,id:Math.random()})}}]),shopApp.controller("mainController",["$scope","$location","$routeParams","productsFactory","ordersFactory",function(t,o,r,e,n){t.pageStyle="mainPageStyle",t.pageClass="page-style",t.products=[],t.orders=[],t.item={};var d=function(){e.getJSON().then(function(o){var r=[];o.data.forEach(function(t){var o={};o.description=t.description,o.title=t.title,o.img=t.img,o.genre=t.genre,o.cost=t.cost,o.id=t.id,r.push(o)}),e.setProducts(r),t.products=r})};t.products=d(),t.orders=n.getOrders()}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIm9yZGVycy5qcyIsInByb2R1Y3RzLmpzIiwiU2hvd09yZGVycy5qcyIsIlNob3dQcm9kdWN0LmpzIiwiYWRkUHJvZHVjdC5qcyIsIm1haW5Db250cm9sbGVyLmpzIl0sIm5hbWVzIjpbInNob3BBcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiaHRtbDVNb2RlIiwiZmFjdG9yeSIsIm9yZGVycyIsImlkIiwidGl0bGUiLCJpbWciLCJkZXNjIiwiY29zdCIsInF1YW50aXR5IiwiZ2V0T3JkZXJzIiwiYWRkT3JkZXIiLCJpdGVtIiwibGVuZ3RoIiwiaXNDb2luY2lkZW5jZSIsImZvckVhY2giLCJvcmRlciIsInB1c2giLCJkZWZpbmVDb3N0Rm9ySXRlbXMiLCJzdW0iLCIkaHR0cCIsIiRsb2NhdGlvbiIsInJlY2lldmVEYXRhIiwiZ2V0IiwicHJvZHVjdHMiLCJnZXRKU09OIiwiZ2V0UHJvZHVjdHMiLCJzZXRQcm9kdWN0cyIsImRhdGEiLCJhZGRQcm9kdWN0IiwibWV0aG9kIiwidXJsIiwiSlNPTiIsInN0cmluZ2lmeSIsInRoZW4iLCJyZXNwb25zZSIsImNvbnNvbGUiLCJsb2ciLCJwYXRoIiwiZGVsZXRlUHJvZHVjdCIsInByb2R1Y3RJbmZvIiwiaW5kZXgiLCJwcm9kdWN0SWQiLCJwcm9kdWN0IiwiZGVsZXRlIiwicGFyYW1zIiwiZmluZFByb2R1Y3RCeUlkIiwiZm91bmQiLCIkc2NvcGUiLCIkcm91dGVQYXJhbXMiLCJwcm9kdWN0c0ZhY3RvcnkiLCJvcmRlcnNGYWN0b3J5IiwicGFnZVN0eWxlIiwic2VsZWN0ZWQiLCJ2YWx1ZSIsInJlbW92ZU9yZGVyIiwic3BsaWNlIiwiUHJvZHVjdElkIiwiY3VycmVudFByb2R1Y3QiLCJnZW5yZSIsImRlc2NyaXB0aW9uIiwiaW5kZXhPZiIsIm5ld1Byb2R1Y3QiLCJNYXRoIiwicmFuZG9tIiwicGFnZUNsYXNzIiwiY3JlYXRlTGlzdCIsIml0ZW1zIiwibGlzdCIsImtleSIsImxpc3RJdGVtIl0sIm1hcHBpbmdzIjoiQUFBQSxhQUdBLElBQUFBLFFBQUFDLFFBQUFDLE9BQUEsV0FBQSxZQUtBRixRQUFBRyxRQUFBLGlCQUFBLG9CQUFBLFNBQUFDLEVBQUFDLEdBRUFELEVBR0FFLEtBQUEsS0FDQUMsWUFBQSx3QkFDQUMsV0FBQSxtQkFJQUYsS0FBQSxRQUNBQyxZQUFBLHVCQUNBQyxXQUFBLGVBSUFGLEtBQUEsV0FDQUMsWUFBQSwwQkFDQUMsV0FBQSxlQUlBRixLQUFBLGdCQUNBQyxZQUFBLDJCQUNBQyxXQUFBLGdCQUNBQyxXQUFBQyxXQUFBLFlBQ0FMLEVBQUFNLFdBQUEsTUNoQ0FYLFFBQUFZLFFBQUEsZ0JBQUEsV0FDQSxJQUFBQyxJQUNBQyxHQUFBLEVBQ0FDLE1BQUEsa0JBQ0FDLElBQUEsaUJBQ0FDLEtBQUEsY0FDQUMsS0FBQSxLQUNBQyxTQUFBLElBRUFQLEtBMkJBLE9BMUJBQSxFQUFBUSxVQUFBLFdBQ0EsT0FBQVAsR0FHQUQsRUFBQVMsU0FBQSxTQUFBQyxHQUVBLEdBQUFULEVBQUFVLE9BQUEsRUFBQSxDQUNBLElBQUFDLEdBQUEsRUFDQVgsRUFBQVksUUFBQSxTQUFBQyxHQUNBSixFQUFBUCxRQUFBVyxFQUFBWCxRQUNBUyxHQUFBLEVBQ0FFLEVBQUFQLGNBR0FLLEdBQ0FYLEVBQUFjLEtBQUFMLEtBSUFWLEVBQUFnQixtQkFBQSxTQUFBZixHQUNBLElBQUFnQixFQUFBLEVBSUEsT0FIQWhCLEVBQUFZLFFBQUEsU0FBQUMsR0FDQUcsSUFBQUgsRUFBQVIsT0FFQVcsR0FFQWpCLElDbkNBWixRQUFBWSxRQUFBLG1CQUFBLFFBQUEsWUFBQSxTQUFBa0IsRUFBQUMsR0FFQSxJQUFBQyxFQUFBLFdBQ0EsT0FBQUYsRUFBQUcsSUFBQSwyQkFFQUMsS0FFQXRCLEtBMkNBLE9BMUNBQSxFQUFBdUIsUUFB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d0IsRUFBQTdDLFVBQ0E2QyxFQUFBcEMsUUFFQSxJQUFBc0QsRUFBQSxXQUNBaEIsRUFBQXpCLFVBQUFTLEtBQUEsU0FBQWlDLEdBQ0EsSUFBQUMsS0FDQUQsRUFBQXZDLEtBQUFiLFFBQUEsU0FBQXNELEdBQ0EsSUFBQUMsS0FDQUEsRUFBQVYsWUFBQVMsRUFBQVQsWUFDQVUsRUFBQWpFLE1BQUFnRSxFQUFBaEUsTUFDQWlFLEVBQUFoRSxJQUFBK0QsRUFBQS9ELElBQ0FnRSxFQUFBWCxNQUFBVSxFQUFBVixNQUNBVyxFQUFBOUQsS0FBQTZELEVBQUE3RCxLQUNBOEQsRUFBQWxFLEdBQUFpRSxFQUFBakUsR0FDQWdFLEVBQUFuRCxLQUFBcUQsS0FFQXBCLEVBQUF2QixZQUFBeUMsR0FDQXBCLEVBQUF4QixTQUFBNEMsS0FLQXBCLEVBQUF4QixTQUFBMEMsSUFDQWxCLEVBQUE3QyxPQUFBZ0QsRUFBQXpDIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vLyBkZWZpbmUgb3VyIGFwcGxpY2F0aW9uIGFuZCBwdWxsIGluIG5nUm91dGUgYW5kIG5nQW5pbWF0ZVxudmFyIHNob3BBcHAgPSBhbmd1bGFyLm1vZHVsZShcInNob3BBcHBcIiwgW1wibmdSb3V0ZVwiXSk7XG4vL1xuLy8gUk9VVElORyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gc2V0IG91ciByb3V0aW5nIGZvciB0aGlzIGFwcGxpY2F0aW9uXG4vLyBlYWNoIHJvdXRlIHdpbGwgcHVsbCBpbiBhIGRpZmZlcmVudCBjb250cm9sbGVyXG5zaG9wQXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuXG4gICAgJHJvdXRlUHJvdmlkZXJcblxuICAgIC8vIGhvbWUgcGFnZVxuICAgIC53aGVuKFwiL1wiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcIi4uL3BhcnRpYWxzL2hvbWUuaHRtbFwiLFxuICAgICAgICBjb250cm9sbGVyOiBcIm1haW5Db250cm9sbGVyXCJcbiAgICB9KVxuXG4gICAgLy8gYWRkIHBhZ2VcbiAgICAud2hlbihcIi9hZGRcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCIuLi9wYXJ0aWFscy9hZGQuaHRtbFwiLFxuICAgICAgICBjb250cm9sbGVyOiBcImFkZFByb2R1Y3RcIlxuICAgIH0pXG5cbiAgICAvLyBvcmRlcnMgcGFnZVxuICAgIC53aGVuKFwiL29yZGVyc1wiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcIi4uL3BhcnRpYWxzL29yZGVycy5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwiU2hvd09yZGVyc1wiXG4gICAgfSlcblxuICAgIC8vIHByb2R1Y3QgcGFnZVxuICAgIC53aGVuKFwiL3Byb2R1Y3QvOmlkXCIsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiLi4vcGFydGlhbHMvcHJvZHVjdC5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwiU2hvd1Byb2R1Y3RcIlxuICAgIH0pLm90aGVyd2lzZSh7IHJlZGlyZWN0VG86IFwiL29yZGVyc1wiIH0pO1xuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbn1dKTsiLCJcInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBzaG9wQXBwLmZhY3RvcnkoXCJvcmRlcnNGYWN0b3J5XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG9yZGVycyA9IFt7XG4gICAgICAgICAgICBpZDogMSxcbiAgICAgICAgICAgIHRpdGxlOiBcIkNhdCBpbiB0aGUgZGFya1wiLFxuICAgICAgICAgICAgaW1nOiAnLi9pbWcvY2F0Mi5qcGcnLFxuICAgICAgICAgICAgZGVzYzogXCJJdHMganVzdCBtZVwiLFxuICAgICAgICAgICAgY29zdDogJzUwJyxcbiAgICAgICAgICAgIHF1YW50aXR5OiAxXG4gICAgICAgIH1dO1xuICAgICAgICB2YXIgZmFjdG9yeSA9IHt9O1xuICAgICAgICBmYWN0b3J5LmdldE9yZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBvcmRlcnM7XG4gICAgICAgIH07XG5cbiAgICAgICAgZmFjdG9yeS5hZGRPcmRlciA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgIGlmIChvcmRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBpc0NvaW5jaWRlbmNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgb3JkZXJzLmZvckVhY2goZnVuY3Rpb24gKG9yZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnRpdGxlID09PSBvcmRlci50aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNDb2luY2lkZW5jZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5xdWFudGl0eSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFpc0NvaW5jaWRlbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIG9yZGVycy5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZmFjdG9yeS5kZWZpbmVDb3N0Rm9ySXRlbXMgPSBmdW5jdGlvbiAob3JkZXJzKSB7XG4gICAgICAgICAgICB2YXIgc3VtID0gMDtcbiAgICAgICAgICAgIG9yZGVycy5mb3JFYWNoKGZ1bmN0aW9uIChvcmRlcikge1xuICAgICAgICAgICAgICAgIHN1bSArPSArb3JkZXIuY29zdDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHN1bTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGZhY3Rvcnk7XG4gICAgfSk7XG59KSgpOyIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIC8vIEZBQ1RPUllcbiAgICBzaG9wQXBwLmZhY3RvcnkoXCJwcm9kdWN0c0ZhY3RvcnlcIiwgW1wiJGh0dHBcIiwgXCIkbG9jYXRpb25cIiwgZnVuY3Rpb24gKCRodHRwLCAkbG9jYXRpb24pIHtcblxuICAgICAgICB2YXIgcmVjaWV2ZURhdGEgPSBmdW5jdGlvbiByZWNpZXZlRGF0YSgpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MC8nKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHByb2R1Y3RzID0gW107XG5cbiAgICAgICAgdmFyIGZhY3RvcnkgPSB7fTtcbiAgICAgICAgZmFjdG9yeS5nZXRKU09OID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlY2lldmVEYXRhKCk7XG4gICAgICAgIH07XG4gICAgICAgIGZhY3RvcnkuZ2V0UHJvZHVjdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvZHVjdHM7XG4gICAgICAgIH07XG4gICAgICAgIGZhY3Rvcnkuc2V0UHJvZHVjdHMgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcHJvZHVjdHMgPSBkYXRhO1xuICAgICAgICB9O1xuICAgICAgICBmYWN0b3J5LmFkZFByb2R1Y3QgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICAgICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MC8nLFxuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGl0ZW0pLFxuICAgICAgICAgICAgICAgIGNvbmZpZzogJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbjsnXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGZhY3RvcnkuZGVsZXRlUHJvZHVjdCA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgIHZhciBwcm9kdWN0SW5mbyA9IHtcbiAgICAgICAgICAgICAgICBpbmRleDogZGF0YS5pbmRleCxcbiAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdC5pZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnaHR0cDovL2xvY2FsaG9zdDo4MDgwL3Byb2R1Y3QvJyArIHByb2R1Y3RJbmZvLnByb2R1Y3RJZCwgeyBwYXJhbXM6IHByb2R1Y3RJbmZvIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGZhY3RvcnkuZmluZFByb2R1Y3RCeUlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICB2YXIgZm91bmQgPSB2b2lkIDA7XG4gICAgICAgICAgICBwcm9kdWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9kdWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb2R1Y3QuaWQgPT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBwcm9kdWN0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZmFjdG9yeTtcbiAgICB9XSk7XG59KSgpOyIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIHNob3BBcHAuY29udHJvbGxlcihcIlNob3dPcmRlcnNcIiwgW1wiJHNjb3BlXCIsIFwiJHJvdXRlUGFyYW1zXCIsIFwicHJvZHVjdHNGYWN0b3J5XCIsIFwib3JkZXJzRmFjdG9yeVwiLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm91dGVQYXJhbXMsIHByb2R1Y3RzRmFjdG9yeSwgb3JkZXJzRmFjdG9yeSkge1xuICAgICAgICAkc2NvcGUucGFnZVN0eWxlID0gJ3Nob3dPcmRlcnNTdHlsZSc7XG4gICAgICAgICRzY29wZS5vcmRlcnMgPSBbXTtcbiAgICAgICAgJHNjb3BlLnN1bSA9IG9yZGVyc0ZhY3RvcnkuZGVmaW5lQ29zdEZvckl0ZW1zKG9yZGVyc0ZhY3RvcnkuZ2V0T3JkZXJzKCkpO1xuICAgICAgICAkc2NvcGUuaXRlbSA9IHt9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSB7IHZhbHVlOiAwIH07XG5cbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVycyA9IG9yZGVyc0ZhY3RvcnkuZ2V0T3JkZXJzKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdCgpO1xuICAgICAgICAkc2NvcGUucmVtb3ZlT3JkZXIgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5vcmRlcnNbaXRlbV0ucXVhbnRpdHkgPiAxKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yZGVyc1tpdGVtXS5xdWFudGl0eSAtPSAxO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUub3JkZXJzW2l0ZW1dLnF1YW50aXR5ID09PSAxKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yZGVycy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfV0pO1xufSkoKTsiLCJcInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBzaG9wQXBwLmNvbnRyb2xsZXIoXCJTaG93UHJvZHVjdFwiLCBbXCIkc2NvcGVcIiwgXCIkcm91dGVQYXJhbXNcIiwgXCJwcm9kdWN0c0ZhY3RvcnlcIiwgXCJvcmRlcnNGYWN0b3J5XCIsIGZ1bmN0aW9uICgkc2NvcGUsICRyb3V0ZVBhcmFtcywgcHJvZHVjdHNGYWN0b3J5LCBvcmRlcnNGYWN0b3J5KSB7XG4gICAgICAgICRzY29wZS5wYWdlU3R5bGUgPSAnc2hvd1Byb2R1Y3RTdHlsZSc7XG4gICAgICAgICRzY29wZS5Qcm9kdWN0SWQgPSAkcm91dGVQYXJhbXMuaWQ7XG4gICAgICAgIHZhciBjdXJyZW50UHJvZHVjdCA9IHByb2R1Y3RzRmFjdG9yeS5maW5kUHJvZHVjdEJ5SWQoJHNjb3BlLlByb2R1Y3RJZCk7XG4gICAgICAgICRzY29wZS5pbWcgPSBjdXJyZW50UHJvZHVjdC5pbWc7XG4gICAgICAgICRzY29wZS50aXRsZSA9IGN1cnJlbnRQcm9kdWN0LnRpdGxlO1xuICAgICAgICAkc2NvcGUuZ2VucmUgPSBjdXJyZW50UHJvZHVjdC5nZW5yZTtcbiAgICAgICAgJHNjb3BlLmRlc2NyaXB0aW9uID0gY3VycmVudFByb2R1Y3QuZGVzY3JpcHRpb247XG4gICAgICAgICRzY29wZS5jb3N0ID0gY3VycmVudFByb2R1Y3QuY29zdDtcbiAgICAgICAgJHNjb3BlLnByb2R1Y3RzID0gcHJvZHVjdHNGYWN0b3J5LmdldFByb2R1Y3RzKCk7XG5cbiAgICAgICAgJHNjb3BlLmFkZE9yZGVyID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIG9yZGVyc0ZhY3RvcnkuYWRkT3JkZXIoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiBjdXJyZW50UHJvZHVjdC50aXRsZSxcbiAgICAgICAgICAgICAgICBpZDogb3JkZXJzRmFjdG9yeS5nZXRPcmRlcnMoKS5sZW5ndGggKyAxLFxuICAgICAgICAgICAgICAgIGNvc3Q6IGN1cnJlbnRQcm9kdWN0LmNvc3QsXG4gICAgICAgICAgICAgICAgcXVhbnRpdHk6IDFcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5kZWxldGVQcm9kdWN0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICB2YXIgaW5kZXggPSAkc2NvcGUucHJvZHVjdHMuaW5kZXhPZihjdXJyZW50UHJvZHVjdCk7XG4gICAgICAgICAgICBwcm9kdWN0c0ZhY3RvcnkuZGVsZXRlUHJvZHVjdCh7XG4gICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGN1cnJlbnRQcm9kdWN0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9XSk7XG59KSgpOyIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIHNob3BBcHAuY29udHJvbGxlcihcImFkZFByb2R1Y3RcIiwgW1wiJHNjb3BlXCIsIFwicHJvZHVjdHNGYWN0b3J5XCIsIGZ1bmN0aW9uICgkc2NvcGUsIHByb2R1Y3RzRmFjdG9yeSkge1xuICAgICAgICAkc2NvcGUucGFnZVN0eWxlID0gJ2FkZFN0eWxlJztcblxuICAgICAgICAkc2NvcGUuYWRkUHJvZHVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHByb2R1Y3RzRmFjdG9yeS5hZGRQcm9kdWN0KHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJHNjb3BlLm5ld1Byb2R1Y3QudGl0bGUsXG4gICAgICAgICAgICAgICAgaW1nOiAkc2NvcGUubmV3UHJvZHVjdC5pbWcsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICRzY29wZS5uZXdQcm9kdWN0LmRlc2MsXG4gICAgICAgICAgICAgICAgZ2VucmU6ICRzY29wZS5uZXdQcm9kdWN0LmdlbnJlLFxuICAgICAgICAgICAgICAgIGNvc3Q6ICRzY29wZS5uZXdQcm9kdWN0LmNvc3QsXG4gICAgICAgICAgICAgICAgaWQ6IE1hdGgucmFuZG9tKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH1dKTtcbn0pKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgICAvLyBDT05UUk9MTEVSUyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIGhvbWUgcGFnZSBjb250cm9sbGVyXG4gICAgc2hvcEFwcC5jb250cm9sbGVyKFwibWFpbkNvbnRyb2xsZXJcIiwgW1wiJHNjb3BlXCIsIFwiJGxvY2F0aW9uXCIsIFwiJHJvdXRlUGFyYW1zXCIsIFwicHJvZHVjdHNGYWN0b3J5XCIsIFwib3JkZXJzRmFjdG9yeVwiLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sICRyb3V0ZVBhcmFtcywgcHJvZHVjdHNGYWN0b3J5LCBvcmRlcnNGYWN0b3J5KSB7XG4gICAgICAgICRzY29wZS5wYWdlU3R5bGUgPSAnbWFpblBhZ2VTdHlsZSc7XG4gICAgICAgICRzY29wZS5wYWdlQ2xhc3MgPSBcInBhZ2Utc3R5bGVcIjtcbiAgICAgICAgJHNjb3BlLnByb2R1Y3RzID0gW107XG4gICAgICAgICRzY29wZS5vcmRlcnMgPSBbXTtcbiAgICAgICAgJHNjb3BlLml0ZW0gPSB7fTtcblxuICAgICAgICB2YXIgY3JlYXRlTGlzdCA9IGZ1bmN0aW9uIGNyZWF0ZUxpc3QoKSB7XG4gICAgICAgICAgICBwcm9kdWN0c0ZhY3RvcnkuZ2V0SlNPTigpLnRoZW4oZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICBpdGVtcy5kYXRhLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlzdEl0ZW0gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgbGlzdEl0ZW0uZGVzY3JpcHRpb24gPSBrZXkuZGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgICAgIGxpc3RJdGVtLnRpdGxlID0ga2V5LnRpdGxlO1xuICAgICAgICAgICAgICAgICAgICBsaXN0SXRlbS5pbWcgPSBrZXkuaW1nO1xuICAgICAgICAgICAgICAgICAgICBsaXN0SXRlbS5nZW5yZSA9IGtleS5nZW5yZTtcbiAgICAgICAgICAgICAgICAgICAgbGlzdEl0ZW0uY29zdCA9IGtleS5jb3N0O1xuICAgICAgICAgICAgICAgICAgICBsaXN0SXRlbS5pZCA9IGtleS5pZDtcbiAgICAgICAgICAgICAgICAgICAgbGlzdC5wdXNoKGxpc3RJdGVtKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBwcm9kdWN0c0ZhY3Rvcnkuc2V0UHJvZHVjdHMobGlzdCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3RzID0gbGlzdDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICRzY29wZS5wcm9kdWN0cyA9IGNyZWF0ZUxpc3QoKTtcbiAgICAgICAgICAgICRzY29wZS5vcmRlcnMgPSBvcmRlcnNGYWN0b3J5LmdldE9yZGVycygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGluaXQoKTtcbiAgICB9XSk7XG59KSgpOyJdfQ==
