"use strict";var shopApp=angular.module("shopApp",["ngRoute","ngAnimate"]);shopApp.config(["$routeProvider","$locationProvider",function(t,e){t.when("/",{templateUrl:"../partials/home.html",controller:"mainController"}).when("/add",{templateUrl:"../partials/add.html",controller:"addProduct"}).when("/orders",{templateUrl:"../partials/orders.html",controller:"ShowOrders"}).when("/product/:id",{templateUrl:"../partials/product.html",controller:"ShowProduct"}).otherwise({redirectTo:"/orders"}),e.html5Mode(!0)}]),angular.module("shopApp").run(["$templateCache",function(t){t.put("../partials/add.html",'<div class={{pageStyle}}><h1>Добро пожаловать</h1><h2 class=text-primary>Добавить книгу в список</h2><form name=form class=css-form novalidate><div class=form-group><label for=name>Title <input type=text id=name name=name class=form-control data-ng-model=newProduct.title required ng-minlength=2></label><p ng-show=form.name.$error.minlength class=help-block>Название книги слишком короткое.</p></div><div class=form-group><label for=img>Image url <input type=text id=img class=form-control name=img data-ng-model=newProduct.img required ng-pattern="/^(https?:\\/\\/)?([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-]*)*\\/?$/"></label><p ng-show=form.img.$error.pattern class=help-block>Укажите изображение книги.</p></div><div class=form-group><label for=genre>Genre <input type=text id=genre class=form-control name=genre data-ng-model=newProduct.genre required ng-minlength=2></label><p ng-show=form.genre.$error.minlength class=help-block>Какого жанра эта книга.</p></div><div class=form-group><label for=cost>Cost <input type=text id=cost class=form-control name=cost data-ng-model=newProduct.cost required ng-pattern="/^[0-9]{1,}$/"></label><p ng-show=form.cost.$error.pattern class=help-block>Введите стоимость книги.</p></div><div class=form-group><label for=desc>Description <textarea id=desc name=desc class=form-control data-ng-model=newProduct.desc required ng-minlength=2></textarea></label><p ng-show=form.desc.$error.minlength class=help-block>Укажите описание книги.</p></div><div class=buttonWrapper><button type=submit data-ng-click=addProduct() class="btn btn-success" ng-disabled=form.$invalid>Добавить</button> <a href="/" class="btn btn-primary">На главную</a></div></form></div>'),t.put("../partials/home.html",'<div class="{{ pageStyle }}"><h1>Книжный магазин</h1><h2>Книги на любой вкус</h2><div class=buttons><a href=/add class="btn btn-primary btn-lg">Добавить книгу</a> <a href=/orders data-ng-click=setOrdersNumber() class="btn btn-primary btn-lg">Мои заказы <span class="glyphicon glyphicon-flash" aria-hidden=true></span> {{orders.length}}</a></div><select name=sorting-list data-ng-model=sortList><option disabled selected style="display: none;">Сортировать по:</option><option value=title>Название</option><option value=genre>Жанр</option><option value=cost>Цена по возрастанию</option></select><ul class=list><li data-ng-repeat="prod in products | filter: filters | orderBy: sortList" data-ng-click=showProduct(prod) data-ng-model=item><md-card><p class=genre>{{ prod.genre }}</p><a href="/product/{{ prod.id }}"><h3>{{ prod.title }}</h3><img src="{{ prod.img }}" width=100 class=md-card-image alt="image caption"><br></a><p class=desc>{{ prod.description.substring(0, 50) }} ...</p><div class=cost>{{prod.cost}} | currency</div></md-card></li></ul><div class=pagedown-list><ul><li class=list data-ng-repeat="genre in genreList"><span ng-click=myFilter(genre)>{{genre}}</span></li><li class=list ng-click=myFilter(null)><span>Показать все книги</span></li></ul></div></div>'),t.put("../partials/orders.html",'<div class={{pageStyle}}><h1>Книжная лавочка</h1><h2>Твои заказы</h2><ul class=orders-list><li data-ng-repeat=\'order in orders | filter: order.id | orderBy: "id"\'>№ {{ order.id }}. <span>{{ order.title }}</span> - {{ order.quantity }} pc ({{ order.cost*order.quantity}} $)<button class="btn btn-danger" data-ng-click=removeOrder($index)>Удалить</button></li></ul><div class=sum><span>Общая сумма:</span> <span class=sumInfo>{{ sum }} $</span></div><a href="/" class="btn btn-primary btn-lg">На главную</a></div>'),t.put("../partials/product.html",'<div class={{pageStyle}}><a href=#orders class="btn btn-primary btn-lg buy" data-ng-click=addOrder(item)>Купить всего за $ {{ cost }}</a><div class=product-content><h1>{{ title}}</h1><img class=img-responsive src="{{ img }}" alt=img width=300><p class=desc>{{ description }}</p><p><b>Жанр: <span>{{genre}}</span></b></p></div><a href=/orders ng-click=deleteProduct() class="btn btn-warning">Удалить книгу</a> <a href="/" class="btn btn-info">На главную</a></div>')}]),shopApp.factory("ordersFactory",function(){var t=[{id:1,title:"Cat in the dark",img:"./img/cat2.jpg",desc:"Its just me",cost:"50",quantity:1}],e={};return e.getOrders=function(){return t},e.addOrder=function(e){if(t.length>0){var r=!1;t.forEach(function(t){e.title===t.title&&(r=!0,t.quantity++)}),r||t.push(e)}},e.defineCostForItems=function(t){var e=0;return t.forEach(function(t){e+=+t.cost}),e},e}),shopApp.factory("productsFactory",["$http","$location",function(t,e){var r=function(){return t.get("http://localhost:8080/",{cache:!0})},o=[],n={};return n.getJSON=function(){return r()},n.getProducts=function(){return o},n.setProducts=function(t){o=t},n.addProduct=function(r){t({method:"post",url:"http://localhost:8080/",data:JSON.stringify(r),config:"Content-Type: application/json;"}).then(function(t){console.log(t),e.path("/")},function(t){console.log(t)})},n.deleteProduct=function(e){var r={index:e.index,productId:e.product.id};t.delete("http://localhost:8080/product/"+r.productId,{params:r}).then(function(t){console.log(t)})},n.findProductById=function(t){var e=void 0;return o.forEach(function(r){r.id==t&&(e=r)}),e},n}]),shopApp.controller("ShowOrders",["$scope","$routeParams","productsFactory","ordersFactory",function(t,e,r,o){t.pageStyle="showOrdersStyle",t.orders=[],t.sum=o.defineCostForItems(o.getOrders()),t.item={},t.selected={value:0};t.orders=o.getOrders(),t.removeOrder=function(e){t.orders[e].quantity>1?t.orders[e].quantity-=1:1===t.orders[e].quantity&&t.orders.splice(e,1)}}]),shopApp.controller("ShowProduct",["$scope","$routeParams","productsFactory","ordersFactory",function(t,e,r,o){t.pageStyle="showProductStyle",t.ProductId=e.id;var n=r.findProductById(t.ProductId);t.img=n.img,t.title=n.title,t.genre=n.genre,t.description=n.description,t.cost=n.cost,t.products=r.getProducts(),t.addOrder=function(t){o.addOrder({title:n.title,id:o.getOrders().length+1,cost:n.cost,quantity:1})},t.deleteProduct=function(){var e=t.products.indexOf(n);r.deleteProduct({index:e,product:n})}}]),shopApp.controller("addProduct",["$scope","productsFactory",function(t,e){t.pageStyle="addStyle",t.addProduct=function(){t.newProduct.title="",t.newProduct.img="",t.newProduct.desc="",t.newProduct.genre="",t.newProduct.cost="",e.addProduct({title:t.newProduct.title,img:t.newProduct.img,description:t.newProduct.desc,genre:t.newProduct.genre,cost:+t.newProduct.cost,id:Math.random()})}}]),shopApp.controller("mainController",["$scope","$location","$routeParams","productsFactory","ordersFactory",function(t,e,r,o,n){t.pageStyle="mainPageStyle",t.pageClass="page-style",t.products=[],t.orders=[],t.item={},t.genreList=[],t.filters="";var s=function(){o.getJSON().then(function(e){var r=[];e.data.forEach(function(t){var e={};e.description=t.description,e.title=t.title,e.img=t.img,e.genre=t.genre,e.cost=+t.cost,e.id=t.id,r.push(e)}),o.setProducts(r),t.products=r;var n=_.map(r,"genre");t.genreList=_.uniq(n),t.myFilter=function(e){t.filters=e}})};t.products=s(),t.orders=n.getOrders()}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInRlbXBsYXRlcy5qcyIsIm9yZGVycy5qcyIsInByb2R1Y3RzLmpzIiwiU2hvd09yZGVycy5qcyIsIlNob3dQcm9kdWN0LmpzIiwiYWRkUHJvZHVjdC5qcyIsIm1haW5Db250cm9sbGVyLmpzIl0sIm5hbWVzIjpbInNob3BBcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiaHRtbDVNb2RlIiwicnVuIiwiJHRlbXBsYXRlQ2FjaGUiLCJwdXQiLCJmYWN0b3J5Iiwib3JkZXJzIiwiaWQiLCJ0aXRsZSIsImltZyIsImRlc2MiLCJjb3N0IiwicXVhbnRpdHkiLCJnZXRPcmRlcnMiLCJhZGRPcmRlciIsIml0ZW0iLCJsZW5ndGgiLCJpc0NvaW5jaWRlbmNlIiwiZm9yRWFjaCIsIm9yZGVyIiwicHVzaCIsImRlZmluZUNvc3RGb3JJdGVtcyIsInN1bSIsIiRodHRwIiwiJGxvY2F0aW9uIiwicmVjaWV2ZURhdGEiLCJnZXQiLCJjYWNoZSIsInByb2R1Y3RzIiwiZ2V0SlNPTiIsImdldFByb2R1Y3RzIiwic2V0UHJvZHVjdHMiLCJkYXRhIiwiYWRkUHJvZHVjdCIsIm1ldGhvZCIsInVybCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGVuIiwicmVzcG9uc2UiLCJjb25zb2xlIiwibG9nIiwicGF0aCIsImRlbGV0ZVByb2R1Y3QiLCJwcm9kdWN0SW5mbyIsImluZGV4IiwicHJvZHVjdElkIiwicHJvZHVjdCIsImRlbGV0ZSIsInBhcmFtcyIsImZpbmRQcm9kdWN0QnlJZCIsImZvdW5kIiwiJHNjb3BlIiwiJHJvdXRlUGFyYW1zIiwicHJvZHVjdHNGYWN0b3J5Iiwib3JkZXJzRmFjdG9yeSIsInBhZ2VTdHlsZSIsInNlbGVjdGVkIiwidmFsdWUiLCJyZW1vdmVPcmRlciIsInNwbGljZSIsIlByb2R1Y3RJZCIsImN1cnJlbnRQcm9kdWN0IiwiZ2VucmUiLCJkZXNjcmlwdGlvbiIsImluZGV4T2YiLCJuZXdQcm9kdWN0IiwiTWF0aCIsInJhbmRvbSIsInBhZ2VDbGFzcyIsImdlbnJlTGlzdCIsImZpbHRlcnMiLCJjcmVhdGVMaXN0IiwiaXRlbXMiLCJsaXN0Iiwia2V5IiwibGlzdEl0ZW0iLCJfIiwibWFwIiwidW5pcSIsIm15RmlsdGVyIiwibGluayJdLCJtYXBwaW5ncyI6IkFBQUEsYUFHQSxJQUFBQSxRQUFBQyxRQUFBQyxPQUFBLFdBQUEsVUFBQSxjQUtBRixRQUFBRyxRQUFBLGlCQUFBLG9CQUFBLFNBQUFDLEVBQUFDLEdBRUFELEVBR0FFLEtBQUEsS0FDQUMsWUFBQSx3QkFDQUMsV0FBQSxtQkFJQUYsS0FBQSxRQUNBQyxZQUFBLHVCQUNBQyxXQUFBLGVBSUFGLEtBQUEsV0FDQUMsWUFBQSwwQkFDQUMsV0FBQSxlQUlBRixLQUFBLGdCQUNBQyxZQUFBLDJCQUNBQyxXQUFBLGdCQUNBQyxXQUFBQyxXQUFBLFlBQ0FMLEVBQUFNLFdBQUEsTUNuQ0FWLFFBQUFDLE9BQUEsV0FBQVUsS0FBQSxpQkFBQSxTQUFBQyxHQUFBQSxFQUFBQyxJQUFBLHVCQUFBLHdxREFDQUQsRUFBQUMsSUFBQSx3QkFBQSw0dkNBQ0FELEVBQUFDLElBQUEsMEJBQUEscWdCQUNBRCxFQUFBQyxJQUFBLDJCQUFBLHFkQ0FBZCxRQUFBZSxRQUFBLGdCQUFBLFdBQ0EsSUFBQUMsSUFDQUMsR0FBQSxFQUNBQyxNQUFBLGtCQUNBQyxJQUFBLGlCQUNBQyxLQUFBLGNBQ0FDLEtBQUEsS0FDQUMsU0FBQSxJQUVBUCxLQTJCQSxPQTFCQUEsRUFBQVEsVUFBQSxXQUNBLE9BQUFQLEdBR0FELEVBQUFTLFNBQUEsU0FBQUMsR0FFQSxHQUFBVCxFQUFBVSxPQUFBLEVBQUEsQ0FDQSxJQUFBQyxHQUFBLEVBQ0FYLEVBQUFZLFFBQUEsU0FBQUMsR0FDQUosRUFBQVAsUUFBQVcsRUFBQVgsUUFDQVMsR0FBQSxFQUNBRSxF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QUNBcEIsRUFBQTlDLE9BQUFpRCxFQUFBMUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vIGRlZmluZSBvdXIgYXBwbGljYXRpb24gYW5kIHB1bGwgaW4gbmdSb3V0ZSBhbmQgbmdBbmltYXRlXG52YXIgc2hvcEFwcCA9IGFuZ3VsYXIubW9kdWxlKFwic2hvcEFwcFwiLCBbXCJuZ1JvdXRlXCIsIFwibmdBbmltYXRlXCJdKTtcblxuLy8gUk9VVElORyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gc2V0IG91ciByb3V0aW5nIGZvciB0aGlzIGFwcGxpY2F0aW9uXG4vLyBlYWNoIHJvdXRlIHdpbGwgcHVsbCBpbiBhIGRpZmZlcmVudCBjb250cm9sbGVyXG5zaG9wQXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuXG4gICAgJHJvdXRlUHJvdmlkZXJcblxuICAgIC8vIGhvbWUgcGFnZVxuICAgIC53aGVuKFwiL1wiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcIi4uL3BhcnRpYWxzL2hvbWUuaHRtbFwiLFxuICAgICAgICBjb250cm9sbGVyOiBcIm1haW5Db250cm9sbGVyXCJcbiAgICB9KVxuXG4gICAgLy8gYWRkIHBhZ2VcbiAgICAud2hlbihcIi9hZGRcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCIuLi9wYXJ0aWFscy9hZGQuaHRtbFwiLFxuICAgICAgICBjb250cm9sbGVyOiBcImFkZFByb2R1Y3RcIlxuICAgIH0pXG5cbiAgICAvLyBvcmRlcnMgcGFnZVxuICAgIC53aGVuKFwiL29yZGVyc1wiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcIi4uL3BhcnRpYWxzL29yZGVycy5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwiU2hvd09yZGVyc1wiXG4gICAgfSlcblxuICAgIC8vIHByb2R1Y3QgcGFnZVxuICAgIC53aGVuKFwiL3Byb2R1Y3QvOmlkXCIsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiLi4vcGFydGlhbHMvcHJvZHVjdC5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwiU2hvd1Byb2R1Y3RcIlxuICAgIH0pLm90aGVyd2lzZSh7IHJlZGlyZWN0VG86IFwiL29yZGVyc1wiIH0pO1xuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnc2hvcEFwcCcpLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHskdGVtcGxhdGVDYWNoZS5wdXQoJy4uL3BhcnRpYWxzL2FkZC5odG1sJywnPGRpdiBjbGFzcz17e3BhZ2VTdHlsZX19PjxoMT5cXHUwNDE0XFx1MDQzRVxcdTA0MzFcXHUwNDQwXFx1MDQzRSBcXHUwNDNGXFx1MDQzRVxcdTA0MzZcXHUwNDMwXFx1MDQzQlxcdTA0M0VcXHUwNDMyXFx1MDQzMFxcdTA0NDJcXHUwNDRDPC9oMT48aDIgY2xhc3M9dGV4dC1wcmltYXJ5PlxcdTA0MTRcXHUwNDNFXFx1MDQzMVxcdTA0MzBcXHUwNDMyXFx1MDQzOFxcdTA0NDJcXHUwNDRDIFxcdTA0M0FcXHUwNDNEXFx1MDQzOFxcdTA0MzNcXHUwNDQzIFxcdTA0MzIgXFx1MDQ0MVxcdTA0M0ZcXHUwNDM4XFx1MDQ0MVxcdTA0M0VcXHUwNDNBPC9oMj48Zm9ybSBuYW1lPWZvcm0gY2xhc3M9Y3NzLWZvcm0gbm92YWxpZGF0ZT48ZGl2IGNsYXNzPWZvcm0tZ3JvdXA+PGxhYmVsIGZvcj1uYW1lPlRpdGxlIDxpbnB1dCB0eXBlPXRleHQgaWQ9bmFtZSBuYW1lPW5hbWUgY2xhc3M9Zm9ybS1jb250cm9sIGRhdGEtbmctbW9kZWw9bmV3UHJvZHVjdC50aXRsZSByZXF1aXJlZCBuZy1taW5sZW5ndGg9Mj48L2xhYmVsPjxwIG5nLXNob3c9Zm9ybS5uYW1lLiRlcnJvci5taW5sZW5ndGggY2xhc3M9aGVscC1ibG9jaz5cXHUwNDFEXFx1MDQzMFxcdTA0MzdcXHUwNDMyXFx1MDQzMFxcdTA0M0RcXHUwNDM4XFx1MDQzNSBcXHUwNDNBXFx1MDQzRFxcdTA0MzhcXHUwNDMzXFx1MDQzOCBcXHUwNDQxXFx1MDQzQlxcdTA0MzhcXHUwNDQ4XFx1MDQzQVxcdTA0M0VcXHUwNDNDIFxcdTA0M0FcXHUwNDNFXFx1MDQ0MFxcdTA0M0VcXHUwNDQyXFx1MDQzQVxcdTA0M0VcXHUwNDM1LjwvcD48L2Rpdj48ZGl2IGNsYXNzPWZvcm0tZ3JvdXA+PGxhYmVsIGZvcj1pbWc+SW1hZ2UgdXJsIDxpbnB1dCB0eXBlPXRleHQgaWQ9aW1nIGNsYXNzPWZvcm0tY29udHJvbCBuYW1lPWltZyBkYXRhLW5nLW1vZGVsPW5ld1Byb2R1Y3QuaW1nIHJlcXVpcmVkIG5nLXBhdHRlcm49XCIvXihodHRwcz86XFxcXC9cXFxcLyk/KFtcXFxcZGEtelxcXFwuLV0rKVxcXFwuKFthLXpcXFxcLl17Miw2fSkoW1xcXFwvXFxcXHcgXFxcXC4tXSopKlxcXFwvPyQvXCI+PC9sYWJlbD48cCBuZy1zaG93PWZvcm0uaW1nLiRlcnJvci5wYXR0ZXJuIGNsYXNzPWhlbHAtYmxvY2s+XFx1MDQyM1xcdTA0M0FcXHUwNDMwXFx1MDQzNlxcdTA0MzhcXHUwNDQyXFx1MDQzNSBcXHUwNDM4XFx1MDQzN1xcdTA0M0VcXHUwNDMxXFx1MDQ0MFxcdTA0MzBcXHUwNDM2XFx1MDQzNVxcdTA0M0RcXHUwNDM4XFx1MDQzNSBcXHUwNDNBXFx1MDQzRFxcdTA0MzhcXHUwNDMzXFx1MDQzOC48L3A+PC9kaXY+PGRpdiBjbGFzcz1mb3JtLWdyb3VwPjxsYWJlbCBmb3I9Z2VucmU+R2VucmUgPGlucHV0IHR5cGU9dGV4dCBpZD1nZW5yZSBjbGFzcz1mb3JtLWNvbnRyb2wgbmFtZT1nZW5yZSBkYXRhLW5nLW1vZGVsPW5ld1Byb2R1Y3QuZ2VucmUgcmVxdWlyZWQgbmctbWlubGVuZ3RoPTI+PC9sYWJlbD48cCBuZy1zaG93PWZvcm0uZ2VucmUuJGVycm9yLm1pbmxlbmd0aCBjbGFzcz1oZWxwLWJsb2NrPlxcdTA0MUFcXHUwNDMwXFx1MDQzQVxcdTA0M0VcXHUwNDMzXFx1MDQzRSBcXHUwNDM2XFx1MDQzMFxcdTA0M0RcXHUwNDQwXFx1MDQzMCBcXHUwNDREXFx1MDQ0MlxcdTA0MzAgXFx1MDQzQVxcdTA0M0RcXHUwNDM4XFx1MDQzM1xcdTA0MzAuPC9wPjwvZGl2PjxkaXYgY2xhc3M9Zm9ybS1ncm91cD48bGFiZWwgZm9yPWNvc3Q+Q29zdCA8aW5wdXQgdHlwZT10ZXh0IGlkPWNvc3QgY2xhc3M9Zm9ybS1jb250cm9sIG5hbWU9Y29zdCBkYXRhLW5nLW1vZGVsPW5ld1Byb2R1Y3QuY29zdCByZXF1aXJlZCBuZy1wYXR0ZXJuPVwiL15bMC05XXsxLH0kL1wiPjwvbGFiZWw+PHAgbmctc2hvdz1mb3JtLmNvc3QuJGVycm9yLnBhdHRlcm4gY2xhc3M9aGVscC1ibG9jaz5cXHUwNDEyXFx1MDQzMlxcdTA0MzVcXHUwNDM0XFx1MDQzOFxcdTA0NDJcXHUwNDM1IFxcdTA0NDFcXHUwNDQyXFx1MDQzRVxcdTA0MzhcXHUwNDNDXFx1MDQzRVxcdTA0NDFcXHUwNDQyXFx1MDQ0QyBcXHUwNDNBXFx1MDQzRFxcdTA0MzhcXHUwNDMzXFx1MDQzOC48L3A+PC9kaXY+PGRpdiBjbGFzcz1mb3JtLWdyb3VwPjxsYWJlbCBmb3I9ZGVzYz5EZXNjcmlwdGlvbiA8dGV4dGFyZWEgaWQ9ZGVzYyBuYW1lPWRlc2MgY2xhc3M9Zm9ybS1jb250cm9sIGRhdGEtbmctbW9kZWw9bmV3UHJvZHVjdC5kZXNjIHJlcXVpcmVkIG5nLW1pbmxlbmd0aD0yPjwvdGV4dGFyZWE+PC9sYWJlbD48cCBuZy1zaG93PWZvcm0uZGVzYy4kZXJyb3IubWlubGVuZ3RoIGNsYXNzPWhlbHAtYmxvY2s+XFx1MDQyM1xcdTA0M0FcXHUwNDMwXFx1MDQzNlxcdTA0MzhcXHUwNDQyXFx1MDQzNSBcXHUwNDNFXFx1MDQzRlxcdTA0MzhcXHUwNDQxXFx1MDQzMFxcdTA0M0RcXHUwNDM4XFx1MDQzNSBcXHUwNDNBXFx1MDQzRFxcdTA0MzhcXHUwNDMzXFx1MDQzOC48L3A+PC9kaXY+PGRpdiBjbGFzcz1idXR0b25XcmFwcGVyPjxidXR0b24gdHlwZT1zdWJtaXQgZGF0YS1uZy1jbGljaz1hZGRQcm9kdWN0KCkgY2xhc3M9XCJidG4gYnRuLXN1Y2Nlc3NcIiBuZy1kaXNhYmxlZD1mb3JtLiRpbnZhbGlkPlxcdTA0MTRcXHUwNDNFXFx1MDQzMVxcdTA0MzBcXHUwNDMyXFx1MDQzOFxcdTA0NDJcXHUwNDRDPC9idXR0b24+IDxhIGhyZWY9XCIvXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIj5cXHUwNDFEXFx1MDQzMCBcXHUwNDMzXFx1MDQzQlxcdTA0MzBcXHUwNDMyXFx1MDQzRFxcdTA0NDNcXHUwNDRFPC9hPjwvZGl2PjwvZm9ybT48L2Rpdj4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi4vcGFydGlhbHMvaG9tZS5odG1sJywnPGRpdiBjbGFzcz1cInt7IHBhZ2VTdHlsZSB9fVwiPjxoMT5cXHUwNDFBXFx1MDQzRFxcdTA0MzhcXHUwNDM2XFx1MDQzRFxcdTA0NEJcXHUwNDM5IFxcdTA0M0NcXHUwNDMwXFx1MDQzM1xcdTA0MzBcXHUwNDM3XFx1MDQzOFxcdTA0M0Q8L2gxPjxoMj5cXHUwNDFBXFx1MDQzRFxcdTA0MzhcXHUwNDMzXFx1MDQzOCBcXHUwNDNEXFx1MDQzMCBcXHUwNDNCXFx1MDQ0RVxcdTA0MzFcXHUwNDNFXFx1MDQzOSBcXHUwNDMyXFx1MDQzQVxcdTA0NDNcXHUwNDQxPC9oMj48ZGl2IGNsYXNzPWJ1dHRvbnM+PGEgaHJlZj0vYWRkIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi1sZ1wiPlxcdTA0MTRcXHUwNDNFXFx1MDQzMVxcdTA0MzBcXHUwNDMyXFx1MDQzOFxcdTA0NDJcXHUwNDRDIFxcdTA0M0FcXHUwNDNEXFx1MDQzOFxcdTA0MzNcXHUwNDQzPC9hPiA8YSBocmVmPS9vcmRlcnMgZGF0YS1uZy1jbGljaz1zZXRPcmRlcnNOdW1iZXIoKSBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBidG4tbGdcIj5cXHUwNDFDXFx1MDQzRVxcdTA0MzggXFx1MDQzN1xcdTA0MzBcXHUwNDNBXFx1MDQzMFxcdTA0MzdcXHUwNDRCIDxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1mbGFzaFwiIGFyaWEtaGlkZGVuPXRydWU+PC9zcGFuPiB7e29yZGVycy5sZW5ndGh9fTwvYT48L2Rpdj48c2VsZWN0IG5hbWU9c29ydGluZy1saXN0IGRhdGEtbmctbW9kZWw9c29ydExpc3Q+PG9wdGlvbiBkaXNhYmxlZCBzZWxlY3RlZCBzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCI+XFx1MDQyMVxcdTA0M0VcXHUwNDQwXFx1MDQ0MlxcdTA0MzhcXHUwNDQwXFx1MDQzRVxcdTA0MzJcXHUwNDMwXFx1MDQ0MlxcdTA0NEMgXFx1MDQzRlxcdTA0M0U6PC9vcHRpb24+PG9wdGlvbiB2YWx1ZT10aXRsZT5cXHUwNDFEXFx1MDQzMFxcdTA0MzdcXHUwNDMyXFx1MDQzMFxcdTA0M0RcXHUwNDM4XFx1MDQzNTwvb3B0aW9uPjxvcHRpb24gdmFsdWU9Z2VucmU+XFx1MDQxNlxcdTA0MzBcXHUwNDNEXFx1MDQ0MDwvb3B0aW9uPjxvcHRpb24gdmFsdWU9Y29zdD5cXHUwNDI2XFx1MDQzNVxcdTA0M0RcXHUwNDMwIFxcdTA0M0ZcXHUwNDNFIFxcdTA0MzJcXHUwNDNFXFx1MDQzN1xcdTA0NDBcXHUwNDMwXFx1MDQ0MVxcdTA0NDJcXHUwNDMwXFx1MDQzRFxcdTA0MzhcXHUwNDRFPC9vcHRpb24+PC9zZWxlY3Q+PHVsIGNsYXNzPWxpc3Q+PGxpIGRhdGEtbmctcmVwZWF0PVwicHJvZCBpbiBwcm9kdWN0cyB8IGZpbHRlcjogZmlsdGVycyB8IG9yZGVyQnk6IHNvcnRMaXN0XCIgZGF0YS1uZy1jbGljaz1zaG93UHJvZHVjdChwcm9kKSBkYXRhLW5nLW1vZGVsPWl0ZW0+PG1kLWNhcmQ+PHAgY2xhc3M9Z2VucmU+e3sgcHJvZC5nZW5yZSB9fTwvcD48YSBocmVmPVwiL3Byb2R1Y3Qve3sgcHJvZC5pZCB9fVwiPjxoMz57eyBwcm9kLnRpdGxlIH19PC9oMz48aW1nIHNyYz1cInt7IHByb2QuaW1nIH19XCIgd2lkdGg9MTAwIGNsYXNzPW1kLWNhcmQtaW1hZ2UgYWx0PVwiaW1hZ2UgY2FwdGlvblwiPjxicj48L2E+PHAgY2xhc3M9ZGVzYz57eyBwcm9kLmRlc2NyaXB0aW9uLnN1YnN0cmluZygwLCA1MCkgfX0gLi4uPC9wPjxkaXYgY2xhc3M9Y29zdD57e3Byb2QuY29zdH19IHwgY3VycmVuY3k8L2Rpdj48L21kLWNhcmQ+PC9saT48L3VsPjxkaXYgY2xhc3M9cGFnZWRvd24tbGlzdD48dWw+PGxpIGNsYXNzPWxpc3QgZGF0YS1uZy1yZXBlYXQ9XCJnZW5yZSBpbiBnZW5yZUxpc3RcIj48c3BhbiBuZy1jbGljaz1teUZpbHRlcihnZW5yZSk+e3tnZW5yZX19PC9zcGFuPjwvbGk+PGxpIGNsYXNzPWxpc3QgbmctY2xpY2s9bXlGaWx0ZXIobnVsbCk+PHNwYW4+XFx1MDQxRlxcdTA0M0VcXHUwNDNBXFx1MDQzMFxcdTA0MzdcXHUwNDMwXFx1MDQ0MlxcdTA0NEMgXFx1MDQzMlxcdTA0NDFcXHUwNDM1IFxcdTA0M0FcXHUwNDNEXFx1MDQzOFxcdTA0MzNcXHUwNDM4PC9zcGFuPjwvbGk+PC91bD48L2Rpdj48L2Rpdj4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi4vcGFydGlhbHMvb3JkZXJzLmh0bWwnLCc8ZGl2IGNsYXNzPXt7cGFnZVN0eWxlfX0+PGgxPlxcdTA0MUFcXHUwNDNEXFx1MDQzOFxcdTA0MzZcXHUwNDNEXFx1MDQzMFxcdTA0NEYgXFx1MDQzQlxcdTA0MzBcXHUwNDMyXFx1MDQzRVxcdTA0NDdcXHUwNDNBXFx1MDQzMDwvaDE+PGgyPlxcdTA0MjJcXHUwNDMyXFx1MDQzRVxcdTA0MzggXFx1MDQzN1xcdTA0MzBcXHUwNDNBXFx1MDQzMFxcdTA0MzdcXHUwNDRCPC9oMj48dWwgY2xhc3M9b3JkZXJzLWxpc3Q+PGxpIGRhdGEtbmctcmVwZWF0PVxcJ29yZGVyIGluIG9yZGVycyB8IGZpbHRlcjogb3JkZXIuaWQgfCBvcmRlckJ5OiBcImlkXCJcXCc+XFx1MjExNiB7eyBvcmRlci5pZCB9fS4gPHNwYW4+e3sgb3JkZXIudGl0bGUgfX08L3NwYW4+IC0ge3sgb3JkZXIucXVhbnRpdHkgfX0gcGMgKHt7IG9yZGVyLmNvc3Qqb3JkZXIucXVhbnRpdHl9fSAkKTxidXR0b24gY2xhc3M9XCJidG4gYnRuLWRhbmdlclwiIGRhdGEtbmctY2xpY2s9cmVtb3ZlT3JkZXIoJGluZGV4KT5cXHUwNDIzXFx1MDQzNFxcdTA0MzBcXHUwNDNCXFx1MDQzOFxcdTA0NDJcXHUwNDRDPC9idXR0b24+PC9saT48L3VsPjxkaXYgY2xhc3M9c3VtPjxzcGFuPlxcdTA0MUVcXHUwNDMxXFx1MDQ0OVxcdTA0MzBcXHUwNDRGIFxcdTA0NDFcXHUwNDQzXFx1MDQzQ1xcdTA0M0NcXHUwNDMwOjwvc3Bhbj4gPHNwYW4gY2xhc3M9c3VtSW5mbz57eyBzdW0gfX0gJDwvc3Bhbj48L2Rpdj48YSBocmVmPVwiL1wiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi1sZ1wiPlxcdTA0MURcXHUwNDMwIFxcdTA0MzNcXHUwNDNCXFx1MDQzMFxcdTA0MzJcXHUwNDNEXFx1MDQ0M1xcdTA0NEU8L2E+PC9kaXY+Jyk7XG4kdGVtcGxhdGVDYWNoZS5wdXQoJy4uL3BhcnRpYWxzL3Byb2R1Y3QuaHRtbCcsJzxkaXYgY2xhc3M9e3twYWdlU3R5bGV9fT48YSBocmVmPSNvcmRlcnMgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgYnRuLWxnIGJ1eVwiIGRhdGEtbmctY2xpY2s9YWRkT3JkZXIoaXRlbSk+XFx1MDQxQVxcdTA0NDNcXHUwNDNGXFx1MDQzOFxcdTA0NDJcXHUwNDRDIFxcdTA0MzJcXHUwNDQxXFx1MDQzNVxcdTA0MzNcXHUwNDNFIFxcdTA0MzdcXHUwNDMwICQge3sgY29zdCB9fTwvYT48ZGl2IGNsYXNzPXByb2R1Y3QtY29udGVudD48aDE+e3sgdGl0bGV9fTwvaDE+PGltZyBjbGFzcz1pbWctcmVzcG9uc2l2ZSBzcmM9XCJ7eyBpbWcgfX1cIiBhbHQ9aW1nIHdpZHRoPTMwMD48cCBjbGFzcz1kZXNjPnt7IGRlc2NyaXB0aW9uIH19PC9wPjxwPjxiPlxcdTA0MTZcXHUwNDMwXFx1MDQzRFxcdTA0NDA6IDxzcGFuPnt7Z2VucmV9fTwvc3Bhbj48L2I+PC9wPjwvZGl2PjxhIGhyZWY9L29yZGVycyBuZy1jbGljaz1kZWxldGVQcm9kdWN0KCkgY2xhc3M9XCJidG4gYnRuLXdhcm5pbmdcIj5cXHUwNDIzXFx1MDQzNFxcdTA0MzBcXHUwNDNCXFx1MDQzOFxcdTA0NDJcXHUwNDRDIFxcdTA0M0FcXHUwNDNEXFx1MDQzOFxcdTA0MzNcXHUwNDQzPC9hPiA8YSBocmVmPVwiL1wiIGNsYXNzPVwiYnRuIGJ0bi1pbmZvXCI+XFx1MDQxRFxcdTA0MzAgXFx1MDQzM1xcdTA0M0JcXHUwNDMwXFx1MDQzMlxcdTA0M0RcXHUwNDQzXFx1MDQ0RTwvYT48L2Rpdj4nKTt9XSk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgc2hvcEFwcC5mYWN0b3J5KFwib3JkZXJzRmFjdG9yeVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBvcmRlcnMgPSBbe1xuICAgICAgICAgICAgaWQ6IDEsXG4gICAgICAgICAgICB0aXRsZTogXCJDYXQgaW4gdGhlIGRhcmtcIixcbiAgICAgICAgICAgIGltZzogJy4vaW1nL2NhdDIuanBnJyxcbiAgICAgICAgICAgIGRlc2M6IFwiSXRzIGp1c3QgbWVcIixcbiAgICAgICAgICAgIGNvc3Q6ICc1MCcsXG4gICAgICAgICAgICBxdWFudGl0eTogMVxuICAgICAgICB9XTtcbiAgICAgICAgdmFyIGZhY3RvcnkgPSB7fTtcbiAgICAgICAgZmFjdG9yeS5nZXRPcmRlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gb3JkZXJzO1xuICAgICAgICB9O1xuXG4gICAgICAgIGZhY3RvcnkuYWRkT3JkZXIgPSBmdW5jdGlvbiAoaXRlbSkge1xuXG4gICAgICAgICAgICBpZiAob3JkZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgaXNDb2luY2lkZW5jZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG9yZGVycy5mb3JFYWNoKGZ1bmN0aW9uIChvcmRlcikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS50aXRsZSA9PT0gb3JkZXIudGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQ29pbmNpZGVuY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIucXVhbnRpdHkrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmICghaXNDb2luY2lkZW5jZSkge1xuICAgICAgICAgICAgICAgICAgICBvcmRlcnMucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGZhY3RvcnkuZGVmaW5lQ29zdEZvckl0ZW1zID0gZnVuY3Rpb24gKG9yZGVycykge1xuICAgICAgICAgICAgdmFyIHN1bSA9IDA7XG4gICAgICAgICAgICBvcmRlcnMuZm9yRWFjaChmdW5jdGlvbiAob3JkZXIpIHtcbiAgICAgICAgICAgICAgICBzdW0gKz0gK29yZGVyLmNvc3Q7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBzdW07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBmYWN0b3J5O1xuICAgIH0pO1xufSkoKTsiLCJcInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAvLyBGQUNUT1JZXG4gICAgc2hvcEFwcC5mYWN0b3J5KFwicHJvZHVjdHNGYWN0b3J5XCIsIFtcIiRodHRwXCIsIFwiJGxvY2F0aW9uXCIsIGZ1bmN0aW9uICgkaHR0cCwgJGxvY2F0aW9uKSB7XG5cbiAgICAgICAgdmFyIHJlY2lldmVEYXRhID0gZnVuY3Rpb24gcmVjaWV2ZURhdGEoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjgwODAvJywgeyBjYWNoZTogdHJ1ZSB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHByb2R1Y3RzID0gW107XG5cbiAgICAgICAgdmFyIGZhY3RvcnkgPSB7fTtcbiAgICAgICAgZmFjdG9yeS5nZXRKU09OID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlY2lldmVEYXRhKCk7XG4gICAgICAgIH07XG4gICAgICAgIGZhY3RvcnkuZ2V0UHJvZHVjdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvZHVjdHM7XG4gICAgICAgIH07XG4gICAgICAgIGZhY3Rvcnkuc2V0UHJvZHVjdHMgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcHJvZHVjdHMgPSBkYXRhO1xuICAgICAgICB9O1xuICAgICAgICBmYWN0b3J5LmFkZFByb2R1Y3QgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICAgICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MC8nLFxuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGl0ZW0pLFxuICAgICAgICAgICAgICAgIGNvbmZpZzogJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbjsnXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGZhY3RvcnkuZGVsZXRlUHJvZHVjdCA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgIHZhciBwcm9kdWN0SW5mbyA9IHtcbiAgICAgICAgICAgICAgICBpbmRleDogZGF0YS5pbmRleCxcbiAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdC5pZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnaHR0cDovL2xvY2FsaG9zdDo4MDgwL3Byb2R1Y3QvJyArIHByb2R1Y3RJbmZvLnByb2R1Y3RJZCwgeyBwYXJhbXM6IHByb2R1Y3RJbmZvIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGZhY3RvcnkuZmluZFByb2R1Y3RCeUlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICB2YXIgZm91bmQgPSB2b2lkIDA7XG4gICAgICAgICAgICBwcm9kdWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9kdWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb2R1Y3QuaWQgPT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBwcm9kdWN0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZmFjdG9yeTtcbiAgICB9XSk7XG59KSgpOyIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIHNob3BBcHAuY29udHJvbGxlcihcIlNob3dPcmRlcnNcIiwgW1wiJHNjb3BlXCIsIFwiJHJvdXRlUGFyYW1zXCIsIFwicHJvZHVjdHNGYWN0b3J5XCIsIFwib3JkZXJzRmFjdG9yeVwiLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm91dGVQYXJhbXMsIHByb2R1Y3RzRmFjdG9yeSwgb3JkZXJzRmFjdG9yeSkge1xuICAgICAgICAkc2NvcGUucGFnZVN0eWxlID0gJ3Nob3dPcmRlcnNTdHlsZSc7XG4gICAgICAgICRzY29wZS5vcmRlcnMgPSBbXTtcbiAgICAgICAgJHNjb3BlLnN1bSA9IG9yZGVyc0ZhY3RvcnkuZGVmaW5lQ29zdEZvckl0ZW1zKG9yZGVyc0ZhY3RvcnkuZ2V0T3JkZXJzKCkpO1xuICAgICAgICAkc2NvcGUuaXRlbSA9IHt9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSB7IHZhbHVlOiAwIH07XG5cbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVycyA9IG9yZGVyc0ZhY3RvcnkuZ2V0T3JkZXJzKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdCgpO1xuICAgICAgICAkc2NvcGUucmVtb3ZlT3JkZXIgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5vcmRlcnNbaXRlbV0ucXVhbnRpdHkgPiAxKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yZGVyc1tpdGVtXS5xdWFudGl0eSAtPSAxO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUub3JkZXJzW2l0ZW1dLnF1YW50aXR5ID09PSAxKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yZGVycy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfV0pO1xufSkoKTsiLCJcInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBzaG9wQXBwLmNvbnRyb2xsZXIoXCJTaG93UHJvZHVjdFwiLCBbXCIkc2NvcGVcIiwgXCIkcm91dGVQYXJhbXNcIiwgXCJwcm9kdWN0c0ZhY3RvcnlcIiwgXCJvcmRlcnNGYWN0b3J5XCIsIGZ1bmN0aW9uICgkc2NvcGUsICRyb3V0ZVBhcmFtcywgcHJvZHVjdHNGYWN0b3J5LCBvcmRlcnNGYWN0b3J5KSB7XG4gICAgICAgICRzY29wZS5wYWdlU3R5bGUgPSAnc2hvd1Byb2R1Y3RTdHlsZSc7XG4gICAgICAgICRzY29wZS5Qcm9kdWN0SWQgPSAkcm91dGVQYXJhbXMuaWQ7XG4gICAgICAgIHZhciBjdXJyZW50UHJvZHVjdCA9IHByb2R1Y3RzRmFjdG9yeS5maW5kUHJvZHVjdEJ5SWQoJHNjb3BlLlByb2R1Y3RJZCk7XG4gICAgICAgICRzY29wZS5pbWcgPSBjdXJyZW50UHJvZHVjdC5pbWc7XG4gICAgICAgICRzY29wZS50aXRsZSA9IGN1cnJlbnRQcm9kdWN0LnRpdGxlO1xuICAgICAgICAkc2NvcGUuZ2VucmUgPSBjdXJyZW50UHJvZHVjdC5nZW5yZTtcbiAgICAgICAgJHNjb3BlLmRlc2NyaXB0aW9uID0gY3VycmVudFByb2R1Y3QuZGVzY3JpcHRpb247XG4gICAgICAgICRzY29wZS5jb3N0ID0gY3VycmVudFByb2R1Y3QuY29zdDtcbiAgICAgICAgJHNjb3BlLnByb2R1Y3RzID0gcHJvZHVjdHNGYWN0b3J5LmdldFByb2R1Y3RzKCk7XG5cbiAgICAgICAgJHNjb3BlLmFkZE9yZGVyID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIG9yZGVyc0ZhY3RvcnkuYWRkT3JkZXIoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiBjdXJyZW50UHJvZHVjdC50aXRsZSxcbiAgICAgICAgICAgICAgICBpZDogb3JkZXJzRmFjdG9yeS5nZXRPcmRlcnMoKS5sZW5ndGggKyAxLFxuICAgICAgICAgICAgICAgIGNvc3Q6IGN1cnJlbnRQcm9kdWN0LmNvc3QsXG4gICAgICAgICAgICAgICAgcXVhbnRpdHk6IDFcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5kZWxldGVQcm9kdWN0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICB2YXIgaW5kZXggPSAkc2NvcGUucHJvZHVjdHMuaW5kZXhPZihjdXJyZW50UHJvZHVjdCk7XG4gICAgICAgICAgICBwcm9kdWN0c0ZhY3RvcnkuZGVsZXRlUHJvZHVjdCh7XG4gICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGN1cnJlbnRQcm9kdWN0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9XSk7XG59KSgpOyIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIHNob3BBcHAuY29udHJvbGxlcihcImFkZFByb2R1Y3RcIiwgW1wiJHNjb3BlXCIsIFwicHJvZHVjdHNGYWN0b3J5XCIsIGZ1bmN0aW9uICgkc2NvcGUsIHByb2R1Y3RzRmFjdG9yeSkge1xuICAgICAgICAkc2NvcGUucGFnZVN0eWxlID0gJ2FkZFN0eWxlJztcblxuICAgICAgICAkc2NvcGUuYWRkUHJvZHVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5uZXdQcm9kdWN0LnRpdGxlID0gJyc7XG4gICAgICAgICAgICAkc2NvcGUubmV3UHJvZHVjdC5pbWcgPSAnJztcbiAgICAgICAgICAgICRzY29wZS5uZXdQcm9kdWN0LmRlc2MgPSAnJztcbiAgICAgICAgICAgICRzY29wZS5uZXdQcm9kdWN0LmdlbnJlID0gJyc7XG4gICAgICAgICAgICAkc2NvcGUubmV3UHJvZHVjdC5jb3N0ID0gJyc7XG5cbiAgICAgICAgICAgIHByb2R1Y3RzRmFjdG9yeS5hZGRQcm9kdWN0KHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJHNjb3BlLm5ld1Byb2R1Y3QudGl0bGUsXG4gICAgICAgICAgICAgICAgaW1nOiAkc2NvcGUubmV3UHJvZHVjdC5pbWcsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICRzY29wZS5uZXdQcm9kdWN0LmRlc2MsXG4gICAgICAgICAgICAgICAgZ2VucmU6ICRzY29wZS5uZXdQcm9kdWN0LmdlbnJlLFxuICAgICAgICAgICAgICAgIGNvc3Q6ICskc2NvcGUubmV3UHJvZHVjdC5jb3N0LFxuICAgICAgICAgICAgICAgIGlkOiBNYXRoLnJhbmRvbSgpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9XSk7XG59KSgpOyIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gICAgLy8gQ09OVFJPTExFUlMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAvLyBob21lIHBhZ2UgY29udHJvbGxlclxuICAgIHNob3BBcHAuY29udHJvbGxlcihcIm1haW5Db250cm9sbGVyXCIsIFtcIiRzY29wZVwiLCBcIiRsb2NhdGlvblwiLCBcIiRyb3V0ZVBhcmFtc1wiLCBcInByb2R1Y3RzRmFjdG9yeVwiLCBcIm9yZGVyc0ZhY3RvcnlcIiwgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkcm91dGVQYXJhbXMsIHByb2R1Y3RzRmFjdG9yeSwgb3JkZXJzRmFjdG9yeSkge1xuICAgICAgICAkc2NvcGUucGFnZVN0eWxlID0gJ21haW5QYWdlU3R5bGUnO1xuICAgICAgICAkc2NvcGUucGFnZUNsYXNzID0gXCJwYWdlLXN0eWxlXCI7XG4gICAgICAgICRzY29wZS5wcm9kdWN0cyA9IFtdO1xuICAgICAgICAkc2NvcGUub3JkZXJzID0gW107XG4gICAgICAgICRzY29wZS5pdGVtID0ge307XG4gICAgICAgICRzY29wZS5nZW5yZUxpc3QgPSBbXTtcbiAgICAgICAgJHNjb3BlLmZpbHRlcnMgPSAnJztcbiAgICAgICAgdmFyIGNyZWF0ZUxpc3QgPSBmdW5jdGlvbiBjcmVhdGVMaXN0KCkge1xuICAgICAgICAgICAgcHJvZHVjdHNGYWN0b3J5LmdldEpTT04oKS50aGVuKGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gW107XG4gICAgICAgICAgICAgICAgaXRlbXMuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpc3RJdGVtID0ge307XG4gICAgICAgICAgICAgICAgICAgIGxpc3RJdGVtLmRlc2NyaXB0aW9uID0ga2V5LmRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgICAgICBsaXN0SXRlbS50aXRsZSA9IGtleS50aXRsZTtcbiAgICAgICAgICAgICAgICAgICAgbGlzdEl0ZW0uaW1nID0ga2V5LmltZztcbiAgICAgICAgICAgICAgICAgICAgbGlzdEl0ZW0uZ2VucmUgPSBrZXkuZ2VucmU7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RJdGVtLmNvc3QgPSAra2V5LmNvc3Q7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RJdGVtLmlkID0ga2V5LmlkO1xuICAgICAgICAgICAgICAgICAgICBsaXN0LnB1c2gobGlzdEl0ZW0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHByb2R1Y3RzRmFjdG9yeS5zZXRQcm9kdWN0cyhsaXN0KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvZHVjdHMgPSBsaXN0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGdlbnJlTGlzdCA9IF8ubWFwKGxpc3QsICdnZW5yZScpO1xuICAgICAgICAgICAgICAgICRzY29wZS5nZW5yZUxpc3QgPSBfLnVuaXEoZ2VucmVMaXN0KTtcblxuICAgICAgICAgICAgICAgICRzY29wZS5teUZpbHRlciA9IGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5maWx0ZXJzID0gbGluaztcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICRzY29wZS5wcm9kdWN0cyA9IGNyZWF0ZUxpc3QoKTtcbiAgICAgICAgICAgICRzY29wZS5vcmRlcnMgPSBvcmRlcnNGYWN0b3J5LmdldE9yZGVycygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGluaXQoKTtcbiAgICB9XSk7XG59KSgpOyJdfQ==
